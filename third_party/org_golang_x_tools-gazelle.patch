diff -urN b/benchmark/parse/BUILD.bazel c/benchmark/parse/BUILD.bazel
--- b/benchmark/parse/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/benchmark/parse/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,20 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "parse",
+    srcs = ["parse.go"],
+    importpath = "golang.org/x/tools/benchmark/parse",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":parse",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "parse_test",
+    srcs = ["parse_test.go"],
+    embed = [":parse"],
+)
diff -urN b/blog/BUILD.bazel c/blog/BUILD.bazel
--- b/blog/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/blog/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,24 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "blog",
+    srcs = ["blog.go"],
+    importpath = "golang.org/x/tools/blog",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//blog/atom",
+        "//present",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":blog",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "blog_test",
+    srcs = ["blog_test.go"],
+    embed = [":blog"],
+)
diff -urN b/blog/atom/BUILD.bazel c/blog/atom/BUILD.bazel
--- b/blog/atom/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/blog/atom/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "atom",
+    srcs = ["atom.go"],
+    importpath = "golang.org/x/tools/blog/atom",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":atom",
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/auth/authtest/BUILD.bazel c/cmd/auth/authtest/BUILD.bazel
--- b/cmd/auth/authtest/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/auth/authtest/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "authtest_lib",
+    srcs = ["authtest.go"],
+    importpath = "golang.org/x/tools/cmd/auth/authtest",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "authtest",
+    embed = [":authtest_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/auth/cookieauth/BUILD.bazel c/cmd/auth/cookieauth/BUILD.bazel
--- b/cmd/auth/cookieauth/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/auth/cookieauth/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "cookieauth_lib",
+    srcs = ["cookieauth.go"],
+    importpath = "golang.org/x/tools/cmd/auth/cookieauth",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "cookieauth",
+    embed = [":cookieauth_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/auth/gitauth/BUILD.bazel c/cmd/auth/gitauth/BUILD.bazel
--- b/cmd/auth/gitauth/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/auth/gitauth/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "gitauth_lib",
+    srcs = ["gitauth.go"],
+    importpath = "golang.org/x/tools/cmd/auth/gitauth",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "gitauth",
+    embed = [":gitauth_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/auth/netrcauth/BUILD.bazel c/cmd/auth/netrcauth/BUILD.bazel
--- b/cmd/auth/netrcauth/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/auth/netrcauth/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "netrcauth_lib",
+    srcs = ["netrcauth.go"],
+    importpath = "golang.org/x/tools/cmd/auth/netrcauth",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "netrcauth",
+    embed = [":netrcauth_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/benchcmp/BUILD.bazel c/cmd/benchcmp/BUILD.bazel
--- b/cmd/benchcmp/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/benchcmp/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,29 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library", "go_test")
+
+go_library(
+    name = "benchcmp_lib",
+    srcs = [
+        "benchcmp.go",
+        "compare.go",
+        "doc.go",
+    ],
+    importpath = "golang.org/x/tools/cmd/benchcmp",
+    visibility = ["//visibility:private"],
+    deps = ["//benchmark/parse"],
+)
+
+go_binary(
+    name = "benchcmp",
+    embed = [":benchcmp_lib"],
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "benchcmp_test",
+    srcs = [
+        "benchcmp_test.go",
+        "compare_test.go",
+    ],
+    embed = [":benchcmp_lib"],
+    deps = ["//benchmark/parse"],
+)
diff -urN b/cmd/bundle/BUILD.bazel c/cmd/bundle/BUILD.bazel
--- b/cmd/bundle/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/bundle/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,22 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library", "go_test")
+
+go_library(
+    name = "bundle_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/bundle",
+    visibility = ["//visibility:private"],
+    deps = ["//go/loader"],
+)
+
+go_binary(
+    name = "bundle",
+    embed = [":bundle_lib"],
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "bundle_test",
+    srcs = ["main_test.go"],
+    embed = [":bundle_lib"],
+    deps = ["//go/buildutil"],
+)
diff -urN b/cmd/bundle/testdata/src/domain.name/importdecl/BUILD.bazel c/cmd/bundle/testdata/src/domain.name/importdecl/BUILD.bazel
--- b/cmd/bundle/testdata/src/domain.name/importdecl/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/bundle/testdata/src/domain.name/importdecl/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "importdecl",
+    srcs = ["p.go"],
+    importpath = "golang.org/x/tools/cmd/bundle/testdata/src/domain.name/importdecl",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":importdecl",
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/bundle/testdata/src/initial/BUILD.bazel c/cmd/bundle/testdata/src/initial/BUILD.bazel
--- b/cmd/bundle/testdata/src/initial/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/bundle/testdata/src/initial/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,18 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "initial",
+    srcs = [
+        "a.go",
+        "b.go",
+        "c.go",
+    ],
+    importpath = "golang.org/x/tools/cmd/bundle/testdata/src/initial",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":initial",
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/callgraph/BUILD.bazel c/cmd/callgraph/BUILD.bazel
--- b/cmd/callgraph/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/callgraph/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,76 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library", "go_test")
+
+go_library(
+    name = "callgraph_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/callgraph",
+    visibility = ["//visibility:private"],
+    deps = [
+        "//go/buildutil",
+        "//go/callgraph",
+        "//go/callgraph/cha",
+        "//go/callgraph/rta",
+        "//go/callgraph/static",
+        "//go/packages",
+        "//go/pointer",
+        "//go/ssa",
+        "//go/ssa/ssautil",
+    ],
+)
+
+go_binary(
+    name = "callgraph",
+    embed = [":callgraph_lib"],
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "callgraph_test",
+    srcs = ["main_test.go"],
+    embed = [":callgraph_lib"],
+    deps = select({
+        "@io_bazel_rules_go//go/platform:aix": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:darwin": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:dragonfly": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:freebsd": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:illumos": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:ios": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:js": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:linux": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:nacl": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:netbsd": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:openbsd": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:plan9": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:solaris": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:windows": [
+            "//internal/testenv",
+        ],
+        "//conditions:default": [],
+    }),
+)
diff -urN b/cmd/callgraph/testdata/src/pkg/BUILD.bazel c/cmd/callgraph/testdata/src/pkg/BUILD.bazel
--- b/cmd/callgraph/testdata/src/pkg/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/callgraph/testdata/src/pkg/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,20 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library", "go_test")
+
+go_library(
+    name = "pkg_lib",
+    srcs = ["pkg.go"],
+    importpath = "golang.org/x/tools/cmd/callgraph/testdata/src/pkg",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "pkg",
+    embed = [":pkg_lib"],
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "pkg_test",
+    srcs = ["pkg_test.go"],
+    embed = [":pkg_lib"],
+)
diff -urN b/cmd/compilebench/BUILD.bazel c/cmd/compilebench/BUILD.bazel
--- b/cmd/compilebench/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/compilebench/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "compilebench_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/compilebench",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "compilebench",
+    embed = [":compilebench_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/cover/BUILD.bazel c/cmd/cover/BUILD.bazel
--- b/cmd/cover/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/cover/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,71 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library", "go_test")
+
+go_library(
+    name = "cover_lib",
+    srcs = [
+        "cover.go",
+        "doc.go",
+        "func.go",
+        "html.go",
+    ],
+    importpath = "golang.org/x/tools/cmd/cover",
+    visibility = ["//visibility:private"],
+    deps = ["//cover"],
+)
+
+go_binary(
+    name = "cover",
+    embed = [":cover_lib"],
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "cover_test",
+    srcs = ["cover_test.go"],
+    embed = [":cover_lib"],
+    deps = select({
+        "@io_bazel_rules_go//go/platform:aix": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:darwin": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:dragonfly": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:freebsd": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:illumos": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:ios": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:js": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:linux": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:nacl": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:netbsd": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:openbsd": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:plan9": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:solaris": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:windows": [
+            "//internal/testenv",
+        ],
+        "//conditions:default": [],
+    }),
+)
diff -urN b/cmd/cover/testdata/BUILD.bazel c/cmd/cover/testdata/BUILD.bazel
--- b/cmd/cover/testdata/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/cover/testdata/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,17 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "testdata_lib",
+    srcs = [
+        "main.go",
+        "test.go",
+    ],
+    importpath = "golang.org/x/tools/cmd/cover/testdata",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "testdata",
+    embed = [":testdata_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/digraph/BUILD.bazel c/cmd/digraph/BUILD.bazel
--- b/cmd/digraph/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/digraph/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,20 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library", "go_test")
+
+go_library(
+    name = "digraph_lib",
+    srcs = ["digraph.go"],
+    importpath = "golang.org/x/tools/cmd/digraph",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "digraph",
+    embed = [":digraph_lib"],
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "digraph_test",
+    srcs = ["digraph_test.go"],
+    embed = [":digraph_lib"],
+)
diff -urN b/cmd/eg/BUILD.bazel c/cmd/eg/BUILD.bazel
--- b/cmd/eg/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/eg/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,19 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "eg_lib",
+    srcs = ["eg.go"],
+    importpath = "golang.org/x/tools/cmd/eg",
+    visibility = ["//visibility:private"],
+    deps = [
+        "//go/buildutil",
+        "//go/loader",
+        "//refactor/eg",
+    ],
+)
+
+go_binary(
+    name = "eg",
+    embed = [":eg_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/fiximports/BUILD.bazel c/cmd/fiximports/BUILD.bazel
--- b/cmd/fiximports/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/fiximports/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,65 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library", "go_test")
+
+go_library(
+    name = "fiximports_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/fiximports",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "fiximports",
+    embed = [":fiximports_lib"],
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "fiximports_test",
+    srcs = ["main_test.go"],
+    embed = [":fiximports_lib"],
+    deps = select({
+        "@io_bazel_rules_go//go/platform:aix": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:darwin": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:dragonfly": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:freebsd": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:illumos": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:ios": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:js": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:linux": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:nacl": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:netbsd": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:openbsd": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:plan9": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:solaris": [
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:windows": [
+            "//internal/testenv",
+        ],
+        "//conditions:default": [],
+    }),
+)
diff -urN b/cmd/fiximports/testdata/src/fruit.io/banana/BUILD.bazel c/cmd/fiximports/testdata/src/fruit.io/banana/BUILD.bazel
--- b/cmd/fiximports/testdata/src/fruit.io/banana/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/fiximports/testdata/src/fruit.io/banana/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "banana",
+    srcs = ["banana.go"],
+    importpath = "golang.org/x/tools/cmd/fiximports/testdata/src/fruit.io/banana",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":banana",
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/fiximports/testdata/src/fruit.io/orange/BUILD.bazel c/cmd/fiximports/testdata/src/fruit.io/orange/BUILD.bazel
--- b/cmd/fiximports/testdata/src/fruit.io/orange/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/fiximports/testdata/src/fruit.io/orange/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "orange",
+    srcs = ["orange.go"],
+    importpath = "golang.org/x/tools/cmd/fiximports/testdata/src/fruit.io/orange",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":orange",
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/fiximports/testdata/src/fruit.io/pear/BUILD.bazel c/cmd/fiximports/testdata/src/fruit.io/pear/BUILD.bazel
--- b/cmd/fiximports/testdata/src/fruit.io/pear/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/fiximports/testdata/src/fruit.io/pear/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "pear",
+    srcs = ["pear.go"],
+    importpath = "golang.org/x/tools/cmd/fiximports/testdata/src/fruit.io/pear",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":pear",
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/fiximports/testdata/src/new.com/one/BUILD.bazel c/cmd/fiximports/testdata/src/new.com/one/BUILD.bazel
--- b/cmd/fiximports/testdata/src/new.com/one/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/fiximports/testdata/src/new.com/one/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "one",
+    srcs = ["one.go"],
+    importpath = "golang.org/x/tools/cmd/fiximports/testdata/src/new.com/one",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":one",
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/fiximports/testdata/src/old.com/bad/BUILD.bazel c/cmd/fiximports/testdata/src/old.com/bad/BUILD.bazel
--- b/cmd/fiximports/testdata/src/old.com/bad/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/fiximports/testdata/src/old.com/bad/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "bad",
+    srcs = ["bad.go"],
+    importpath = "golang.org/x/tools/cmd/fiximports/testdata/src/old.com/bad",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":bad",
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/fiximports/testdata/src/old.com/one/BUILD.bazel c/cmd/fiximports/testdata/src/old.com/one/BUILD.bazel
--- b/cmd/fiximports/testdata/src/old.com/one/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/fiximports/testdata/src/old.com/one/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "one",
+    srcs = ["one.go"],
+    importpath = "golang.org/x/tools/cmd/fiximports/testdata/src/old.com/one",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":one",
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/fiximports/testdata/src/titanic.biz/bar/BUILD.bazel c/cmd/fiximports/testdata/src/titanic.biz/bar/BUILD.bazel
--- b/cmd/fiximports/testdata/src/titanic.biz/bar/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/fiximports/testdata/src/titanic.biz/bar/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "bar",
+    srcs = ["bar.go"],
+    importpath = "golang.org/x/tools/cmd/fiximports/testdata/src/titanic.biz/bar",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":bar",
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/fiximports/testdata/src/titanic.biz/foo/BUILD.bazel c/cmd/fiximports/testdata/src/titanic.biz/foo/BUILD.bazel
--- b/cmd/fiximports/testdata/src/titanic.biz/foo/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/fiximports/testdata/src/titanic.biz/foo/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "foo",
+    srcs = ["foo.go"],
+    importpath = "golang.org/x/tools/cmd/fiximports/testdata/src/titanic.biz/foo",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":foo",
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/getgo/BUILD.bazel c/cmd/getgo/BUILD.bazel
--- b/cmd/getgo/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/getgo/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,32 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library", "go_test")
+
+go_library(
+    name = "getgo_lib",
+    srcs = [
+        "download.go",
+        "main.go",
+        "path.go",
+        "steps.go",
+        "system.go",
+        "system_unix.go",
+        "system_windows.go",
+    ],
+    importpath = "golang.org/x/tools/cmd/getgo",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "getgo",
+    embed = [":getgo_lib"],
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "getgo_test",
+    srcs = [
+        "download_test.go",
+        "main_test.go",
+        "path_test.go",
+    ],
+    embed = [":getgo_lib"],
+)
diff -urN b/cmd/getgo/server/BUILD.bazel c/cmd/getgo/server/BUILD.bazel
--- b/cmd/getgo/server/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/getgo/server/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "server_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/getgo/server",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "server",
+    embed = [":server_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/go-contrib-init/BUILD.bazel c/cmd/go-contrib-init/BUILD.bazel
--- b/cmd/go-contrib-init/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/go-contrib-init/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,20 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library", "go_test")
+
+go_library(
+    name = "go-contrib-init_lib",
+    srcs = ["contrib.go"],
+    importpath = "golang.org/x/tools/cmd/go-contrib-init",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "go-contrib-init",
+    embed = [":go-contrib-init_lib"],
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "go-contrib-init_test",
+    srcs = ["contrib_test.go"],
+    embed = [":go-contrib-init_lib"],
+)
diff -urN b/cmd/godex/BUILD.bazel c/cmd/godex/BUILD.bazel
--- b/cmd/godex/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/godex/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,24 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "godex_lib",
+    srcs = [
+        "doc.go",
+        "gc.go",
+        "gccgo.go",
+        "godex.go",
+        "isAlias18.go",
+        "isAlias19.go",
+        "print.go",
+        "source.go",
+        "writetype.go",
+    ],
+    importpath = "golang.org/x/tools/cmd/godex",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "godex",
+    embed = [":godex_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/godoc/BUILD.bazel c/cmd/godoc/BUILD.bazel
--- b/cmd/godoc/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/godoc/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,42 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library", "go_test")
+
+go_library(
+    name = "godoc_lib",
+    srcs = [
+        "doc.go",
+        "goroot.go",
+        "handlers.go",
+        "main.go",
+    ],
+    importpath = "golang.org/x/tools/cmd/godoc",
+    visibility = ["//visibility:private"],
+    deps = [
+        "//godoc",
+        "//godoc/analysis",
+        "//godoc/redirect",
+        "//godoc/static",
+        "//godoc/vfs",
+        "//godoc/vfs/gatefs",
+        "//godoc/vfs/mapfs",
+        "//godoc/vfs/zipfs",
+        "//internal/gocommand",
+        "//playground",
+        "@org_golang_x_xerrors//:go_default_library",
+    ],
+)
+
+go_binary(
+    name = "godoc",
+    embed = [":godoc_lib"],
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "godoc_test",
+    srcs = ["godoc_test.go"],
+    embed = [":godoc_lib"],
+    deps = [
+        "//go/packages/packagestest",
+        "//internal/testenv",
+    ],
+)
diff -urN b/cmd/goimports/BUILD.bazel c/cmd/goimports/BUILD.bazel
--- b/cmd/goimports/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/goimports/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,22 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "goimports_lib",
+    srcs = [
+        "doc.go",
+        "goimports.go",
+        "goimports_gc.go",
+    ],
+    importpath = "golang.org/x/tools/cmd/goimports",
+    visibility = ["//visibility:private"],
+    deps = [
+        "//internal/gocommand",
+        "//internal/imports",
+    ],
+)
+
+go_binary(
+    name = "goimports",
+    embed = [":goimports_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/gomvpkg/BUILD.bazel c/cmd/gomvpkg/BUILD.bazel
--- b/cmd/gomvpkg/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/gomvpkg/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,18 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "gomvpkg_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/gomvpkg",
+    visibility = ["//visibility:private"],
+    deps = [
+        "//go/buildutil",
+        "//refactor/rename",
+    ],
+)
+
+go_binary(
+    name = "gomvpkg",
+    embed = [":gomvpkg_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/gorename/BUILD.bazel c/cmd/gorename/BUILD.bazel
--- b/cmd/gorename/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/gorename/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,25 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library", "go_test")
+
+go_library(
+    name = "gorename_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/gorename",
+    visibility = ["//visibility:private"],
+    deps = [
+        "//go/buildutil",
+        "//refactor/rename",
+    ],
+)
+
+go_binary(
+    name = "gorename",
+    embed = [":gorename_lib"],
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "gorename_test",
+    srcs = ["gorename_test.go"],
+    embed = [":gorename_lib"],
+    deps = ["//internal/testenv"],
+)
diff -urN b/cmd/gotype/BUILD.bazel c/cmd/gotype/BUILD.bazel
--- b/cmd/gotype/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/gotype/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,18 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "gotype_lib",
+    srcs = [
+        "gotype.go",
+        "sizesFor18.go",
+        "sizesFor19.go",
+    ],
+    importpath = "golang.org/x/tools/cmd/gotype",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "gotype",
+    embed = [":gotype_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/goyacc/BUILD.bazel c/cmd/goyacc/BUILD.bazel
--- b/cmd/goyacc/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/goyacc/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,17 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "goyacc_lib",
+    srcs = [
+        "doc.go",
+        "yacc.go",
+    ],
+    importpath = "golang.org/x/tools/cmd/goyacc",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "goyacc",
+    embed = [":goyacc_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/goyacc/testdata/expr/BUILD.bazel c/cmd/goyacc/testdata/expr/BUILD.bazel
--- b/cmd/goyacc/testdata/expr/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/goyacc/testdata/expr/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "expr_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/goyacc/testdata/expr",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "expr",
+    embed = [":expr_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/guru/BUILD.bazel c/cmd/guru/BUILD.bazel
--- b/cmd/guru/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/guru/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,56 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library", "go_test")
+
+go_library(
+    name = "guru_lib",
+    srcs = [
+        "callees.go",
+        "callers.go",
+        "callstack.go",
+        "definition.go",
+        "describe.go",
+        "freevars.go",
+        "guru.go",
+        "implements.go",
+        "isAlias18.go",
+        "isAlias19.go",
+        "main.go",
+        "peers.go",
+        "pointsto.go",
+        "pos.go",
+        "referrers.go",
+        "what.go",
+        "whicherrs.go",
+    ],
+    importpath = "golang.org/x/tools/cmd/guru",
+    visibility = ["//visibility:private"],
+    deps = [
+        "//cmd/guru/serial",
+        "//go/ast/astutil",
+        "//go/buildutil",
+        "//go/callgraph",
+        "//go/callgraph/static",
+        "//go/loader",
+        "//go/pointer",
+        "//go/ssa",
+        "//go/ssa/ssautil",
+        "//go/types/typeutil",
+        "//imports",
+        "//refactor/importgraph",
+    ],
+)
+
+go_binary(
+    name = "guru",
+    embed = [":guru_lib"],
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "guru_test",
+    srcs = [
+        "guru_test.go",
+        "unit_test.go",
+    ],
+    embed = [":guru_lib"],
+    deps = ["//internal/testenv"],
+)
diff -urN b/cmd/guru/serial/BUILD.bazel c/cmd/guru/serial/BUILD.bazel
--- b/cmd/guru/serial/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/guru/serial/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "serial",
+    srcs = ["serial.go"],
+    importpath = "golang.org/x/tools/cmd/guru/serial",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":serial",
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/guru/testdata/src/alias/BUILD.bazel c/cmd/guru/testdata/src/alias/BUILD.bazel
--- b/cmd/guru/testdata/src/alias/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/guru/testdata/src/alias/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "alias",
+    srcs = ["alias.go"],
+    importpath = "golang.org/x/tools/cmd/guru/testdata/src/alias",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":alias",
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/guru/testdata/src/calls/BUILD.bazel c/cmd/guru/testdata/src/calls/BUILD.bazel
--- b/cmd/guru/testdata/src/calls/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/guru/testdata/src/calls/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "calls_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/guru/testdata/src/calls",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "calls",
+    embed = [":calls_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/guru/testdata/src/calls-json/BUILD.bazel c/cmd/guru/testdata/src/calls-json/BUILD.bazel
--- b/cmd/guru/testdata/src/calls-json/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/guru/testdata/src/calls-json/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "calls-json_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/guru/testdata/src/calls-json",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "calls-json",
+    embed = [":calls-json_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/guru/testdata/src/definition-json/BUILD.bazel c/cmd/guru/testdata/src/definition-json/BUILD.bazel
--- b/cmd/guru/testdata/src/definition-json/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/guru/testdata/src/definition-json/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,17 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "definition-json",
+    srcs = [
+        "main.go",
+        "type.go",
+    ],
+    importpath = "golang.org/x/tools/cmd/guru/testdata/src/definition-json",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":definition-json",
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/guru/testdata/src/describe/BUILD.bazel c/cmd/guru/testdata/src/describe/BUILD.bazel
--- b/cmd/guru/testdata/src/describe/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/guru/testdata/src/describe/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "describe",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/guru/testdata/src/describe",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":describe",
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/guru/testdata/src/describe-json/BUILD.bazel c/cmd/guru/testdata/src/describe-json/BUILD.bazel
--- b/cmd/guru/testdata/src/describe-json/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/guru/testdata/src/describe-json/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "describe-json",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/guru/testdata/src/describe-json",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":describe-json",
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/guru/testdata/src/freevars/BUILD.bazel c/cmd/guru/testdata/src/freevars/BUILD.bazel
--- b/cmd/guru/testdata/src/freevars/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/guru/testdata/src/freevars/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "freevars_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/guru/testdata/src/freevars",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "freevars",
+    embed = [":freevars_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/guru/testdata/src/implements/BUILD.bazel c/cmd/guru/testdata/src/implements/BUILD.bazel
--- b/cmd/guru/testdata/src/implements/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/guru/testdata/src/implements/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "implements_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/guru/testdata/src/implements",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "implements",
+    embed = [":implements_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/guru/testdata/src/implements-json/BUILD.bazel c/cmd/guru/testdata/src/implements-json/BUILD.bazel
--- b/cmd/guru/testdata/src/implements-json/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/guru/testdata/src/implements-json/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "implements-json_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/guru/testdata/src/implements-json",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "implements-json",
+    embed = [":implements-json_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/guru/testdata/src/implements-methods/BUILD.bazel c/cmd/guru/testdata/src/implements-methods/BUILD.bazel
--- b/cmd/guru/testdata/src/implements-methods/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/guru/testdata/src/implements-methods/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "implements-methods_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/guru/testdata/src/implements-methods",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "implements-methods",
+    embed = [":implements-methods_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/guru/testdata/src/implements-methods-json/BUILD.bazel c/cmd/guru/testdata/src/implements-methods-json/BUILD.bazel
--- b/cmd/guru/testdata/src/implements-methods-json/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/guru/testdata/src/implements-methods-json/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "implements-methods-json_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/guru/testdata/src/implements-methods-json",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "implements-methods-json",
+    embed = [":implements-methods-json_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/guru/testdata/src/imports/BUILD.bazel c/cmd/guru/testdata/src/imports/BUILD.bazel
--- b/cmd/guru/testdata/src/imports/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/guru/testdata/src/imports/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "imports_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/guru/testdata/src/imports",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "imports",
+    embed = [":imports_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/guru/testdata/src/lib/BUILD.bazel c/cmd/guru/testdata/src/lib/BUILD.bazel
--- b/cmd/guru/testdata/src/lib/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/guru/testdata/src/lib/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "lib",
+    srcs = ["lib.go"],
+    importpath = "golang.org/x/tools/cmd/guru/testdata/src/lib",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":lib",
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/guru/testdata/src/lib/sublib/BUILD.bazel c/cmd/guru/testdata/src/lib/sublib/BUILD.bazel
--- b/cmd/guru/testdata/src/lib/sublib/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/guru/testdata/src/lib/sublib/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "sublib",
+    srcs = ["sublib.go"],
+    importpath = "golang.org/x/tools/cmd/guru/testdata/src/lib/sublib",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":sublib",
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/guru/testdata/src/main/BUILD.bazel c/cmd/guru/testdata/src/main/BUILD.bazel
--- b/cmd/guru/testdata/src/main/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/guru/testdata/src/main/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "main_lib",
+    srcs = ["multi.go"],
+    importpath = "golang.org/x/tools/cmd/guru/testdata/src/main",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "main",
+    embed = [":main_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/guru/testdata/src/peers/BUILD.bazel c/cmd/guru/testdata/src/peers/BUILD.bazel
--- b/cmd/guru/testdata/src/peers/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/guru/testdata/src/peers/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "peers_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/guru/testdata/src/peers",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "peers",
+    embed = [":peers_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/guru/testdata/src/peers-json/BUILD.bazel c/cmd/guru/testdata/src/peers-json/BUILD.bazel
--- b/cmd/guru/testdata/src/peers-json/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/guru/testdata/src/peers-json/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "peers-json_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/guru/testdata/src/peers-json",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "peers-json",
+    embed = [":peers-json_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/guru/testdata/src/pointsto/BUILD.bazel c/cmd/guru/testdata/src/pointsto/BUILD.bazel
--- b/cmd/guru/testdata/src/pointsto/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/guru/testdata/src/pointsto/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "pointsto_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/guru/testdata/src/pointsto",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "pointsto",
+    embed = [":pointsto_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/guru/testdata/src/pointsto-json/BUILD.bazel c/cmd/guru/testdata/src/pointsto-json/BUILD.bazel
--- b/cmd/guru/testdata/src/pointsto-json/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/guru/testdata/src/pointsto-json/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "pointsto-json_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/guru/testdata/src/pointsto-json",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "pointsto-json",
+    embed = [":pointsto-json_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/guru/testdata/src/referrers/BUILD.bazel c/cmd/guru/testdata/src/referrers/BUILD.bazel
--- b/cmd/guru/testdata/src/referrers/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/guru/testdata/src/referrers/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,23 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library", "go_test")
+
+go_library(
+    name = "referrers_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/guru/testdata/src/referrers",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "referrers",
+    embed = [":referrers_lib"],
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "referrers_test",
+    srcs = [
+        "ext_test.go",
+        "int_test.go",
+    ],
+    embed = [":referrers_lib"],
+)
diff -urN b/cmd/guru/testdata/src/referrers-json/BUILD.bazel c/cmd/guru/testdata/src/referrers-json/BUILD.bazel
--- b/cmd/guru/testdata/src/referrers-json/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/guru/testdata/src/referrers-json/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "referrers-json_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/guru/testdata/src/referrers-json",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "referrers-json",
+    embed = [":referrers-json_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/guru/testdata/src/reflection/BUILD.bazel c/cmd/guru/testdata/src/reflection/BUILD.bazel
--- b/cmd/guru/testdata/src/reflection/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/guru/testdata/src/reflection/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "reflection_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/guru/testdata/src/reflection",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "reflection",
+    embed = [":reflection_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/guru/testdata/src/softerrs/BUILD.bazel c/cmd/guru/testdata/src/softerrs/BUILD.bazel
--- b/cmd/guru/testdata/src/softerrs/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/guru/testdata/src/softerrs/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "softerrs_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/guru/testdata/src/softerrs",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "softerrs",
+    embed = [":softerrs_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/guru/testdata/src/what/BUILD.bazel c/cmd/guru/testdata/src/what/BUILD.bazel
--- b/cmd/guru/testdata/src/what/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/guru/testdata/src/what/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "what_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/guru/testdata/src/what",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "what",
+    embed = [":what_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/guru/testdata/src/what-json/BUILD.bazel c/cmd/guru/testdata/src/what-json/BUILD.bazel
--- b/cmd/guru/testdata/src/what-json/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/guru/testdata/src/what-json/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "what-json_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/guru/testdata/src/what-json",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "what-json",
+    embed = [":what-json_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/guru/testdata/src/whicherrs/BUILD.bazel c/cmd/guru/testdata/src/whicherrs/BUILD.bazel
--- b/cmd/guru/testdata/src/whicherrs/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/guru/testdata/src/whicherrs/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "whicherrs_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/guru/testdata/src/whicherrs",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "whicherrs",
+    embed = [":whicherrs_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/html2article/BUILD.bazel c/cmd/html2article/BUILD.bazel
--- b/cmd/html2article/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/html2article/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,18 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "html2article_lib",
+    srcs = ["conv.go"],
+    importpath = "golang.org/x/tools/cmd/html2article",
+    visibility = ["//visibility:private"],
+    deps = [
+        "@org_golang_x_net//html:go_default_library",
+        "@org_golang_x_net//html/atom:go_default_library",
+    ],
+)
+
+go_binary(
+    name = "html2article",
+    embed = [":html2article_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/present/BUILD.bazel c/cmd/present/BUILD.bazel
--- b/cmd/present/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/present/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,25 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "present_lib",
+    srcs = [
+        "dir.go",
+        "doc.go",
+        "main.go",
+        "play.go",
+    ],
+    importpath = "golang.org/x/tools/cmd/present",
+    visibility = ["//visibility:private"],
+    deps = [
+        "//godoc/static",
+        "//playground",
+        "//playground/socket",
+        "//present",
+    ],
+)
+
+go_binary(
+    name = "present",
+    embed = [":present_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/present2md/BUILD.bazel c/cmd/present2md/BUILD.bazel
--- b/cmd/present2md/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/present2md/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,15 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "present2md_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/present2md",
+    visibility = ["//visibility:private"],
+    deps = ["//present"],
+)
+
+go_binary(
+    name = "present2md",
+    embed = [":present2md_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/splitdwarf/BUILD.bazel c/cmd/splitdwarf/BUILD.bazel
--- b/cmd/splitdwarf/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/splitdwarf/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,47 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "splitdwarf_lib",
+    srcs = ["splitdwarf.go"],
+    importpath = "golang.org/x/tools/cmd/splitdwarf",
+    visibility = ["//visibility:private"],
+    deps = select({
+        "@io_bazel_rules_go//go/platform:aix": [
+            "//cmd/splitdwarf/internal/macho",
+        ],
+        "@io_bazel_rules_go//go/platform:android": [
+            "//cmd/splitdwarf/internal/macho",
+        ],
+        "@io_bazel_rules_go//go/platform:darwin": [
+            "//cmd/splitdwarf/internal/macho",
+        ],
+        "@io_bazel_rules_go//go/platform:dragonfly": [
+            "//cmd/splitdwarf/internal/macho",
+        ],
+        "@io_bazel_rules_go//go/platform:freebsd": [
+            "//cmd/splitdwarf/internal/macho",
+        ],
+        "@io_bazel_rules_go//go/platform:illumos": [
+            "//cmd/splitdwarf/internal/macho",
+        ],
+        "@io_bazel_rules_go//go/platform:ios": [
+            "//cmd/splitdwarf/internal/macho",
+        ],
+        "@io_bazel_rules_go//go/platform:linux": [
+            "//cmd/splitdwarf/internal/macho",
+        ],
+        "@io_bazel_rules_go//go/platform:netbsd": [
+            "//cmd/splitdwarf/internal/macho",
+        ],
+        "@io_bazel_rules_go//go/platform:openbsd": [
+            "//cmd/splitdwarf/internal/macho",
+        ],
+        "//conditions:default": [],
+    }),
+)
+
+go_binary(
+    name = "splitdwarf",
+    embed = [":splitdwarf_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/splitdwarf/internal/macho/BUILD.bazel c/cmd/splitdwarf/internal/macho/BUILD.bazel
--- b/cmd/splitdwarf/internal/macho/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/splitdwarf/internal/macho/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,27 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "macho",
+    srcs = [
+        "fat.go",
+        "file.go",
+        "macho.go",
+        "reloctype.go",
+        "reloctype_string.go",
+    ],
+    importpath = "golang.org/x/tools/cmd/splitdwarf/internal/macho",
+    visibility = ["//cmd/splitdwarf:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":macho",
+    visibility = ["//cmd/splitdwarf:__subpackages__"],
+)
+
+go_test(
+    name = "macho_test",
+    srcs = ["file_test.go"],
+    data = glob(["testdata/**"]),
+    embed = [":macho"],
+)
diff -urN b/cmd/ssadump/BUILD.bazel c/cmd/ssadump/BUILD.bazel
--- b/cmd/ssadump/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/ssadump/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,21 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "ssadump_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/cmd/ssadump",
+    visibility = ["//visibility:private"],
+    deps = [
+        "//go/buildutil",
+        "//go/packages",
+        "//go/ssa",
+        "//go/ssa/interp",
+        "//go/ssa/ssautil",
+    ],
+)
+
+go_binary(
+    name = "ssadump",
+    embed = [":ssadump_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/stress/BUILD.bazel c/cmd/stress/BUILD.bazel
--- b/cmd/stress/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/stress/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "stress_lib",
+    srcs = ["stress.go"],
+    importpath = "golang.org/x/tools/cmd/stress",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "stress",
+    embed = [":stress_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/stringer/BUILD.bazel c/cmd/stringer/BUILD.bazel
--- b/cmd/stringer/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/stringer/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,26 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library", "go_test")
+
+go_library(
+    name = "stringer_lib",
+    srcs = ["stringer.go"],
+    importpath = "golang.org/x/tools/cmd/stringer",
+    visibility = ["//visibility:private"],
+    deps = ["//go/packages"],
+)
+
+go_binary(
+    name = "stringer",
+    embed = [":stringer_lib"],
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "stringer_test",
+    srcs = [
+        "endtoend_test.go",
+        "golden_test.go",
+        "util_test.go",
+    ],
+    embed = [":stringer_lib"],
+    deps = ["//internal/testenv"],
+)
diff -urN b/cmd/stringer/testdata/BUILD.bazel c/cmd/stringer/testdata/BUILD.bazel
--- b/cmd/stringer/testdata/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/stringer/testdata/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,27 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "testdata_lib",
+    srcs = [
+        "cgo.go",
+        "conv.go",
+        "day.go",
+        "gap.go",
+        "num.go",
+        "number.go",
+        "prime.go",
+        "tag_main.go",
+        "unum.go",
+        "unum2.go",
+        "vary_day.go",
+    ],
+    cgo = True,
+    importpath = "golang.org/x/tools/cmd/stringer/testdata",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "testdata",
+    embed = [":testdata_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/cmd/toolstash/BUILD.bazel c/cmd/toolstash/BUILD.bazel
--- b/cmd/toolstash/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cmd/toolstash/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,17 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "toolstash_lib",
+    srcs = [
+        "cmp.go",
+        "main.go",
+    ],
+    importpath = "golang.org/x/tools/cmd/toolstash",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "toolstash",
+    embed = [":toolstash_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/container/intsets/BUILD.bazel c/container/intsets/BUILD.bazel
--- b/container/intsets/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/container/intsets/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,29 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "intsets",
+    srcs = [
+        "popcnt_amd64.go",
+        "popcnt_amd64.s",
+        "popcnt_generic.go",
+        "sparse.go",
+        "util.go",
+    ],
+    importpath = "golang.org/x/tools/container/intsets",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":intsets",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "intsets_test",
+    srcs = [
+        "sparse_test.go",
+        "util_test.go",
+    ],
+    embed = [":intsets"],
+)
diff -urN b/cover/BUILD.bazel c/cover/BUILD.bazel
--- b/cover/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/cover/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,20 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "cover",
+    srcs = ["profile.go"],
+    importpath = "golang.org/x/tools/cover",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":cover",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "cover_test",
+    srcs = ["profile_test.go"],
+    embed = [":cover"],
+)
diff -urN b/go/analysis/BUILD.bazel c/go/analysis/BUILD.bazel
--- b/go/analysis/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,33 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_tool_library")
+
+go_library(
+    name = "analysis",
+    srcs = [
+        "analysis.go",
+        "diagnostic.go",
+        "doc.go",
+        "validate.go",
+    ],
+    importpath = "golang.org/x/tools/go/analysis",
+    visibility = ["//visibility:public"],
+    deps = ["//internal/analysisinternal"],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = [
+        "analysis.go",
+        "diagnostic.go",
+        "doc.go",
+        "validate.go",
+    ],
+    importpath = "golang.org/x/tools/go/analysis",
+    visibility = ["//visibility:public"],
+    deps = ["//internal/analysisinternal:go_tool_library"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":analysis",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/analysistest/BUILD.bazel c/go/analysis/analysistest/BUILD.bazel
--- b/go/analysis/analysistest/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/analysistest/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,34 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "analysistest",
+    srcs = ["analysistest.go"],
+    importpath = "golang.org/x/tools/go/analysis/analysistest",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/internal/checker",
+        "//go/packages",
+        "//internal/lsp/diff",
+        "//internal/lsp/diff/myers",
+        "//internal/span",
+        "//internal/testenv",
+        "//txtar",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":analysistest",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "analysistest_test",
+    srcs = ["analysistest_test.go"],
+    embed = [":analysistest"],
+    deps = [
+        "//go/analysis/passes/findcall",
+        "//internal/testenv",
+    ],
+)
diff -urN b/go/analysis/internal/analysisflags/BUILD.bazel c/go/analysis/internal/analysisflags/BUILD.bazel
--- b/go/analysis/internal/analysisflags/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/internal/analysisflags/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,25 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "analysisflags",
+    srcs = [
+        "flags.go",
+        "help.go",
+    ],
+    importpath = "golang.org/x/tools/go/analysis/internal/analysisflags",
+    visibility = ["//go/analysis:__subpackages__"],
+    deps = ["//go/analysis"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":analysisflags",
+    visibility = ["//go/analysis:__subpackages__"],
+)
+
+go_test(
+    name = "analysisflags_test",
+    srcs = ["flags_test.go"],
+    embed = [":analysisflags"],
+    deps = ["//go/analysis"],
+)
diff -urN b/go/analysis/internal/checker/BUILD.bazel c/go/analysis/internal/checker/BUILD.bazel
--- b/go/analysis/internal/checker/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/internal/checker/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,34 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "checker",
+    srcs = ["checker.go"],
+    importpath = "golang.org/x/tools/go/analysis/internal/checker",
+    visibility = ["//go/analysis:__subpackages__"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/internal/analysisflags",
+        "//go/packages",
+        "//internal/analysisinternal",
+        "//internal/span",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":checker",
+    visibility = ["//go/analysis:__subpackages__"],
+)
+
+go_test(
+    name = "checker_test",
+    srcs = ["checker_test.go"],
+    embed = [":checker"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/analysistest",
+        "//go/analysis/passes/inspect",
+        "//go/ast/inspector",
+        "//internal/testenv",
+    ],
+)
diff -urN b/go/analysis/internal/facts/BUILD.bazel c/go/analysis/internal/facts/BUILD.bazel
--- b/go/analysis/internal/facts/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/internal/facts/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,46 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "facts",
+    srcs = [
+        "facts.go",
+        "imports.go",
+    ],
+    importpath = "golang.org/x/tools/go/analysis/internal/facts",
+    visibility = ["//go/analysis:__subpackages__"],
+    deps = [
+        "//go/analysis",
+        "//go/types/objectpath",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = [
+        "facts.go",
+        "imports.go",
+    ],
+    importpath = "golang.org/x/tools/go/analysis/internal/facts",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/types/objectpath:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":facts",
+    visibility = ["//go/analysis:__subpackages__"],
+)
+
+go_test(
+    name = "facts_test",
+    srcs = ["facts_test.go"],
+    embed = [":facts"],
+    deps = [
+        "//go/analysis/analysistest",
+        "//go/packages",
+        "//internal/testenv",
+    ],
+)
diff -urN b/go/analysis/multichecker/BUILD.bazel c/go/analysis/multichecker/BUILD.bazel
--- b/go/analysis/multichecker/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/multichecker/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,31 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "multichecker",
+    srcs = ["multichecker.go"],
+    importpath = "golang.org/x/tools/go/analysis/multichecker",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/internal/analysisflags",
+        "//go/analysis/internal/checker",
+        "//go/analysis/unitchecker",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":multichecker",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "multichecker_test",
+    srcs = ["multichecker_test.go"],
+    embed = [":multichecker"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/findcall",
+        "//internal/testenv",
+    ],
+)
diff -urN b/go/analysis/passes/asmdecl/BUILD.bazel c/go/analysis/passes/asmdecl/BUILD.bazel
--- b/go/analysis/passes/asmdecl/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/asmdecl/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,36 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "asmdecl",
+    srcs = ["asmdecl.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/asmdecl",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/internal/analysisutil",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["asmdecl.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/asmdecl",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/analysis/passes/internal/analysisutil:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":asmdecl",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "asmdecl_test",
+    srcs = ["asmdecl_test.go"],
+    embed = [":asmdecl"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/asmdecl/testdata/src/a/BUILD.bazel c/go/analysis/passes/asmdecl/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/asmdecl/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/asmdecl/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,25 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = [
+        "asm.go",
+        "asm1.s",
+        "asm2.s",
+        "asm3.s",
+        "asm4.s",
+        "asm5.s",
+        "asm6.s",
+        "asm7.s",
+        "asm8.s",
+        "asm9.s",
+    ],
+    importpath = "golang.org/x/tools/go/analysis/passes/asmdecl/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/assign/BUILD.bazel c/go/analysis/passes/assign/BUILD.bazel
--- b/go/analysis/passes/assign/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/assign/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,40 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "assign",
+    srcs = ["assign.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/assign",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/analysis/passes/internal/analysisutil",
+        "//go/ast/inspector",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["assign.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/assign",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/analysis/passes/inspect:go_tool_library",
+        "//go/analysis/passes/internal/analysisutil:go_tool_library",
+        "//go/ast/inspector:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":assign",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "assign_test",
+    srcs = ["assign_test.go"],
+    embed = [":assign"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/assign/testdata/src/a/BUILD.bazel c/go/analysis/passes/assign/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/assign/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/assign/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/assign/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/atomic/BUILD.bazel c/go/analysis/passes/atomic/BUILD.bazel
--- b/go/analysis/passes/atomic/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/atomic/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,40 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "atomic",
+    srcs = ["atomic.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/atomic",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/analysis/passes/internal/analysisutil",
+        "//go/ast/inspector",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["atomic.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/atomic",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/analysis/passes/inspect:go_tool_library",
+        "//go/analysis/passes/internal/analysisutil:go_tool_library",
+        "//go/ast/inspector:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":atomic",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "atomic_test",
+    srcs = ["atomic_test.go"],
+    embed = [":atomic"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/atomic/testdata/src/a/BUILD.bazel c/go/analysis/passes/atomic/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/atomic/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/atomic/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/atomic/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/atomicalign/BUILD.bazel c/go/analysis/passes/atomicalign/BUILD.bazel
--- b/go/analysis/passes/atomicalign/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/atomicalign/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,40 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "atomicalign",
+    srcs = ["atomicalign.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/atomicalign",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/analysis/passes/internal/analysisutil",
+        "//go/ast/inspector",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["atomicalign.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/atomicalign",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/analysis/passes/inspect:go_tool_library",
+        "//go/analysis/passes/internal/analysisutil:go_tool_library",
+        "//go/ast/inspector:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":atomicalign",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "atomicalign_test",
+    srcs = ["atomicalign_test.go"],
+    embed = [":atomicalign"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/atomicalign/testdata/src/a/BUILD.bazel c/go/analysis/passes/atomicalign/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/atomicalign/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/atomicalign/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,17 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = [
+        "a.go",
+        "stub.go",
+    ],
+    importpath = "golang.org/x/tools/go/analysis/passes/atomicalign/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/atomicalign/testdata/src/b/BUILD.bazel c/go/analysis/passes/atomicalign/testdata/src/b/BUILD.bazel
--- b/go/analysis/passes/atomicalign/testdata/src/b/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/atomicalign/testdata/src/b/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,17 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "b",
+    srcs = [
+        "b.go",
+        "stub.go",
+    ],
+    importpath = "golang.org/x/tools/go/analysis/passes/atomicalign/testdata/src/b",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":b",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/bools/BUILD.bazel c/go/analysis/passes/bools/BUILD.bazel
--- b/go/analysis/passes/bools/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/bools/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,40 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "bools",
+    srcs = ["bools.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/bools",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/analysis/passes/internal/analysisutil",
+        "//go/ast/inspector",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["bools.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/bools",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/analysis/passes/inspect:go_tool_library",
+        "//go/analysis/passes/internal/analysisutil:go_tool_library",
+        "//go/ast/inspector:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":bools",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "bools_test",
+    srcs = ["bools_test.go"],
+    embed = [":bools"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/bools/testdata/src/a/BUILD.bazel c/go/analysis/passes/bools/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/bools/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/bools/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/bools/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/buildssa/BUILD.bazel c/go/analysis/passes/buildssa/BUILD.bazel
--- b/go/analysis/passes/buildssa/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/buildssa/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,36 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "buildssa",
+    srcs = ["buildssa.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/buildssa",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/ssa",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["buildssa.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/buildssa",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/ssa:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":buildssa",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "buildssa_test",
+    srcs = ["buildssa_test.go"],
+    embed = [":buildssa"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/buildssa/testdata/src/a/BUILD.bazel c/go/analysis/passes/buildssa/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/buildssa/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/buildssa/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/buildssa/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/buildtag/BUILD.bazel c/go/analysis/passes/buildtag/BUILD.bazel
--- b/go/analysis/passes/buildtag/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/buildtag/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,36 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "buildtag",
+    srcs = ["buildtag.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/buildtag",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/internal/analysisutil",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["buildtag.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/buildtag",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/analysis/passes/internal/analysisutil:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":buildtag",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "buildtag_test",
+    srcs = ["buildtag_test.go"],
+    embed = [":buildtag"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/buildtag/testdata/src/a/BUILD.bazel c/go/analysis/passes/buildtag/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/buildtag/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/buildtag/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["buildtag.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/buildtag/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/cgocall/BUILD.bazel c/go/analysis/passes/cgocall/BUILD.bazel
--- b/go/analysis/passes/cgocall/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/cgocall/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,36 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "cgocall",
+    srcs = ["cgocall.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/cgocall",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/internal/analysisutil",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["cgocall.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/cgocall",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/analysis/passes/internal/analysisutil:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":cgocall",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "cgocall_test",
+    srcs = ["cgocall_test.go"],
+    embed = [":cgocall"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/cgocall/testdata/src/a/BUILD.bazel c/go/analysis/passes/cgocall/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/cgocall/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/cgocall/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,18 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = [
+        "cgo.go",
+        "cgo3.go",
+    ],
+    cgo = True,
+    importpath = "golang.org/x/tools/go/analysis/passes/cgocall/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/cgocall/testdata/src/b/BUILD.bazel c/go/analysis/passes/cgocall/testdata/src/b/BUILD.bazel
--- b/go/analysis/passes/cgocall/testdata/src/b/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/cgocall/testdata/src/b/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "b",
+    srcs = ["b.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/cgocall/testdata/src/b",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":b",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/cgocall/testdata/src/c/BUILD.bazel c/go/analysis/passes/cgocall/testdata/src/c/BUILD.bazel
--- b/go/analysis/passes/cgocall/testdata/src/c/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/cgocall/testdata/src/c/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "c",
+    srcs = ["c.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/cgocall/testdata/src/c",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":c",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/composite/BUILD.bazel c/go/analysis/passes/composite/BUILD.bazel
--- b/go/analysis/passes/composite/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/composite/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,44 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "composite",
+    srcs = [
+        "composite.go",
+        "whitelist.go",
+    ],
+    importpath = "golang.org/x/tools/go/analysis/passes/composite",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/ast/inspector",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = [
+        "composite.go",
+        "whitelist.go",
+    ],
+    importpath = "golang.org/x/tools/go/analysis/passes/composite",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/analysis/passes/inspect:go_tool_library",
+        "//go/ast/inspector:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":composite",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "composite_test",
+    srcs = ["composite_test.go"],
+    embed = [":composite"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/composite/testdata/src/a/BUILD.bazel c/go/analysis/passes/composite/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/composite/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/composite/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/composite/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/copylock/BUILD.bazel c/go/analysis/passes/copylock/BUILD.bazel
--- b/go/analysis/passes/copylock/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/copylock/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,40 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "copylock",
+    srcs = ["copylock.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/copylock",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/analysis/passes/internal/analysisutil",
+        "//go/ast/inspector",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["copylock.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/copylock",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/analysis/passes/inspect:go_tool_library",
+        "//go/analysis/passes/internal/analysisutil:go_tool_library",
+        "//go/ast/inspector:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":copylock",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "copylock_test",
+    srcs = ["copylock_test.go"],
+    embed = [":copylock"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/copylock/testdata/src/a/BUILD.bazel c/go/analysis/passes/copylock/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/copylock/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/copylock/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,18 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = [
+        "copylock.go",
+        "copylock_func.go",
+        "copylock_range.go",
+    ],
+    importpath = "golang.org/x/tools/go/analysis/passes/copylock/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/ctrlflow/BUILD.bazel c/go/analysis/passes/ctrlflow/BUILD.bazel
--- b/go/analysis/passes/ctrlflow/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/ctrlflow/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,42 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "ctrlflow",
+    srcs = ["ctrlflow.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/ctrlflow",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/ast/inspector",
+        "//go/cfg",
+        "//go/types/typeutil",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["ctrlflow.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/ctrlflow",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/analysis/passes/inspect:go_tool_library",
+        "//go/ast/inspector:go_tool_library",
+        "//go/cfg:go_tool_library",
+        "//go/types/typeutil:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":ctrlflow",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "ctrlflow_test",
+    srcs = ["ctrlflow_test.go"],
+    embed = [":ctrlflow"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/ctrlflow/testdata/src/a/BUILD.bazel c/go/analysis/passes/ctrlflow/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/ctrlflow/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/ctrlflow/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/ctrlflow/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/ctrlflow/testdata/src/lib/BUILD.bazel c/go/analysis/passes/ctrlflow/testdata/src/lib/BUILD.bazel
--- b/go/analysis/passes/ctrlflow/testdata/src/lib/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/ctrlflow/testdata/src/lib/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "lib",
+    srcs = ["lib.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/ctrlflow/testdata/src/lib",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":lib",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/deepequalerrors/BUILD.bazel c/go/analysis/passes/deepequalerrors/BUILD.bazel
--- b/go/analysis/passes/deepequalerrors/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/deepequalerrors/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,40 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "deepequalerrors",
+    srcs = ["deepequalerrors.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/deepequalerrors",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/ast/inspector",
+        "//go/types/typeutil",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["deepequalerrors.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/deepequalerrors",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/analysis/passes/inspect:go_tool_library",
+        "//go/ast/inspector:go_tool_library",
+        "//go/types/typeutil:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":deepequalerrors",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "deepequalerrors_test",
+    srcs = ["deepequalerrors_test.go"],
+    embed = [":deepequalerrors"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/deepequalerrors/testdata/src/a/BUILD.bazel c/go/analysis/passes/deepequalerrors/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/deepequalerrors/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/deepequalerrors/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/deepequalerrors/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/errorsas/BUILD.bazel c/go/analysis/passes/errorsas/BUILD.bazel
--- b/go/analysis/passes/errorsas/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/errorsas/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,40 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "errorsas",
+    srcs = ["errorsas.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/errorsas",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/ast/inspector",
+        "//go/types/typeutil",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["errorsas.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/errorsas",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/analysis/passes/inspect:go_tool_library",
+        "//go/ast/inspector:go_tool_library",
+        "//go/types/typeutil:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":errorsas",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "errorsas_test",
+    srcs = ["errorsas_test.go"],
+    embed = [":errorsas"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/errorsas/testdata/src/a/BUILD.bazel c/go/analysis/passes/errorsas/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/errorsas/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/errorsas/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/errorsas/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/findcall/BUILD.bazel c/go/analysis/passes/findcall/BUILD.bazel
--- b/go/analysis/passes/findcall/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/findcall/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,30 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "findcall",
+    srcs = ["findcall.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/findcall",
+    visibility = ["//visibility:public"],
+    deps = ["//go/analysis"],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["findcall.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/findcall",
+    visibility = ["//visibility:public"],
+    deps = ["//go/analysis:go_tool_library"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":findcall",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "findcall_test",
+    srcs = ["findcall_test.go"],
+    embed = [":findcall"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/findcall/cmd/findcall/BUILD.bazel c/go/analysis/passes/findcall/cmd/findcall/BUILD.bazel
--- b/go/analysis/passes/findcall/cmd/findcall/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/findcall/cmd/findcall/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,18 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "findcall_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/findcall/cmd/findcall",
+    visibility = ["//visibility:private"],
+    deps = [
+        "//go/analysis/passes/findcall",
+        "//go/analysis/singlechecker",
+    ],
+)
+
+go_binary(
+    name = "findcall",
+    embed = [":findcall_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/findcall/testdata/src/a/BUILD.bazel c/go/analysis/passes/findcall/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/findcall/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/findcall/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "a_lib",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/findcall/testdata/src/a",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "a",
+    embed = [":a_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/httpresponse/BUILD.bazel c/go/analysis/passes/httpresponse/BUILD.bazel
--- b/go/analysis/passes/httpresponse/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/httpresponse/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,40 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "httpresponse",
+    srcs = ["httpresponse.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/httpresponse",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/analysis/passes/internal/analysisutil",
+        "//go/ast/inspector",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["httpresponse.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/httpresponse",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/analysis/passes/inspect:go_tool_library",
+        "//go/analysis/passes/internal/analysisutil:go_tool_library",
+        "//go/ast/inspector:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":httpresponse",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "httpresponse_test",
+    srcs = ["httpresponse_test.go"],
+    embed = [":httpresponse"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/httpresponse/testdata/src/a/BUILD.bazel c/go/analysis/passes/httpresponse/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/httpresponse/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/httpresponse/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/httpresponse/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/ifaceassert/BUILD.bazel c/go/analysis/passes/ifaceassert/BUILD.bazel
--- b/go/analysis/passes/ifaceassert/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/ifaceassert/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,38 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "ifaceassert",
+    srcs = ["ifaceassert.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/ifaceassert",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/ast/inspector",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["ifaceassert.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/ifaceassert",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/analysis/passes/inspect:go_tool_library",
+        "//go/ast/inspector:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":ifaceassert",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "ifaceassert_test",
+    srcs = ["ifaceassert_test.go"],
+    embed = [":ifaceassert"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/ifaceassert/cmd/ifaceassert/BUILD.bazel c/go/analysis/passes/ifaceassert/cmd/ifaceassert/BUILD.bazel
--- b/go/analysis/passes/ifaceassert/cmd/ifaceassert/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/ifaceassert/cmd/ifaceassert/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,18 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "ifaceassert_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/ifaceassert/cmd/ifaceassert",
+    visibility = ["//visibility:private"],
+    deps = [
+        "//go/analysis/passes/ifaceassert",
+        "//go/analysis/singlechecker",
+    ],
+)
+
+go_binary(
+    name = "ifaceassert",
+    embed = [":ifaceassert_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/ifaceassert/testdata/src/a/BUILD.bazel c/go/analysis/passes/ifaceassert/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/ifaceassert/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/ifaceassert/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/ifaceassert/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/inspect/BUILD.bazel c/go/analysis/passes/inspect/BUILD.bazel
--- b/go/analysis/passes/inspect/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/inspect/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,29 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_tool_library")
+
+go_library(
+    name = "inspect",
+    srcs = ["inspect.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/inspect",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/ast/inspector",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["inspect.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/inspect",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/ast/inspector:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":inspect",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/internal/analysisutil/BUILD.bazel c/go/analysis/passes/internal/analysisutil/BUILD.bazel
--- b/go/analysis/passes/internal/analysisutil/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/internal/analysisutil/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,21 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_tool_library")
+
+go_library(
+    name = "analysisutil",
+    srcs = ["util.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/internal/analysisutil",
+    visibility = ["//go/analysis/passes:__subpackages__"],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["util.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/internal/analysisutil",
+    visibility = ["//go/analysis/passes:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":analysisutil",
+    visibility = ["//go/analysis/passes:__subpackages__"],
+)
diff -urN b/go/analysis/passes/loopclosure/BUILD.bazel c/go/analysis/passes/loopclosure/BUILD.bazel
--- b/go/analysis/passes/loopclosure/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/loopclosure/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,38 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "loopclosure",
+    srcs = ["loopclosure.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/loopclosure",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/ast/inspector",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["loopclosure.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/loopclosure",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/analysis/passes/inspect:go_tool_library",
+        "//go/ast/inspector:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":loopclosure",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "loopclosure_test",
+    srcs = ["loopclosure_test.go"],
+    embed = [":loopclosure"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/loopclosure/testdata/src/a/BUILD.bazel c/go/analysis/passes/loopclosure/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/loopclosure/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/loopclosure/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/loopclosure/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/lostcancel/BUILD.bazel c/go/analysis/passes/lostcancel/BUILD.bazel
--- b/go/analysis/passes/lostcancel/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/lostcancel/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,42 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "lostcancel",
+    srcs = ["lostcancel.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/lostcancel",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/ctrlflow",
+        "//go/analysis/passes/inspect",
+        "//go/ast/inspector",
+        "//go/cfg",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["lostcancel.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/lostcancel",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/analysis/passes/ctrlflow:go_tool_library",
+        "//go/analysis/passes/inspect:go_tool_library",
+        "//go/ast/inspector:go_tool_library",
+        "//go/cfg:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":lostcancel",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "lostcancel_test",
+    srcs = ["lostcancel_test.go"],
+    embed = [":lostcancel"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/lostcancel/cmd/lostcancel/BUILD.bazel c/go/analysis/passes/lostcancel/cmd/lostcancel/BUILD.bazel
--- b/go/analysis/passes/lostcancel/cmd/lostcancel/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/lostcancel/cmd/lostcancel/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,18 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "lostcancel_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/lostcancel/cmd/lostcancel",
+    visibility = ["//visibility:private"],
+    deps = [
+        "//go/analysis/passes/lostcancel",
+        "//go/analysis/singlechecker",
+    ],
+)
+
+go_binary(
+    name = "lostcancel",
+    embed = [":lostcancel_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/lostcancel/testdata/src/a/BUILD.bazel c/go/analysis/passes/lostcancel/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/lostcancel/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/lostcancel/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/lostcancel/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/lostcancel/testdata/src/b/BUILD.bazel c/go/analysis/passes/lostcancel/testdata/src/b/BUILD.bazel
--- b/go/analysis/passes/lostcancel/testdata/src/b/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/lostcancel/testdata/src/b/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "b_lib",
+    srcs = ["b.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/lostcancel/testdata/src/b",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "b",
+    embed = [":b_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/nilfunc/BUILD.bazel c/go/analysis/passes/nilfunc/BUILD.bazel
--- b/go/analysis/passes/nilfunc/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/nilfunc/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,38 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "nilfunc",
+    srcs = ["nilfunc.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/nilfunc",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/ast/inspector",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["nilfunc.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/nilfunc",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/analysis/passes/inspect:go_tool_library",
+        "//go/ast/inspector:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":nilfunc",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "nilfunc_test",
+    srcs = ["nilfunc_test.go"],
+    embed = [":nilfunc"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/nilfunc/testdata/src/a/BUILD.bazel c/go/analysis/passes/nilfunc/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/nilfunc/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/nilfunc/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/nilfunc/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/nilness/BUILD.bazel c/go/analysis/passes/nilness/BUILD.bazel
--- b/go/analysis/passes/nilness/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/nilness/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,38 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "nilness",
+    srcs = ["nilness.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/nilness",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/buildssa",
+        "//go/ssa",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["nilness.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/nilness",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/analysis/passes/buildssa:go_tool_library",
+        "//go/ssa:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":nilness",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "nilness_test",
+    srcs = ["nilness_test.go"],
+    embed = [":nilness"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/nilness/cmd/nilness/BUILD.bazel c/go/analysis/passes/nilness/cmd/nilness/BUILD.bazel
--- b/go/analysis/passes/nilness/cmd/nilness/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/nilness/cmd/nilness/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,18 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "nilness_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/nilness/cmd/nilness",
+    visibility = ["//visibility:private"],
+    deps = [
+        "//go/analysis/passes/nilness",
+        "//go/analysis/singlechecker",
+    ],
+)
+
+go_binary(
+    name = "nilness",
+    embed = [":nilness_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/nilness/testdata/src/a/BUILD.bazel c/go/analysis/passes/nilness/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/nilness/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/nilness/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/nilness/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/pkgfact/BUILD.bazel c/go/analysis/passes/pkgfact/BUILD.bazel
--- b/go/analysis/passes/pkgfact/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/pkgfact/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,30 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "pkgfact",
+    srcs = ["pkgfact.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/pkgfact",
+    visibility = ["//visibility:public"],
+    deps = ["//go/analysis"],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["pkgfact.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/pkgfact",
+    visibility = ["//visibility:public"],
+    deps = ["//go/analysis:go_tool_library"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":pkgfact",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "pkgfact_test",
+    srcs = ["pkgfact_test.go"],
+    embed = [":pkgfact"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/pkgfact/testdata/src/a/BUILD.bazel c/go/analysis/passes/pkgfact/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/pkgfact/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/pkgfact/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/pkgfact/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/pkgfact/testdata/src/b/BUILD.bazel c/go/analysis/passes/pkgfact/testdata/src/b/BUILD.bazel
--- b/go/analysis/passes/pkgfact/testdata/src/b/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/pkgfact/testdata/src/b/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "b",
+    srcs = ["b.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/pkgfact/testdata/src/b",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":b",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/pkgfact/testdata/src/c/BUILD.bazel c/go/analysis/passes/pkgfact/testdata/src/c/BUILD.bazel
--- b/go/analysis/passes/pkgfact/testdata/src/c/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/pkgfact/testdata/src/c/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "c",
+    srcs = ["c.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/pkgfact/testdata/src/c",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":c",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/printf/BUILD.bazel c/go/analysis/passes/printf/BUILD.bazel
--- b/go/analysis/passes/printf/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/printf/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,48 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "printf",
+    srcs = [
+        "printf.go",
+        "types.go",
+    ],
+    importpath = "golang.org/x/tools/go/analysis/passes/printf",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/analysis/passes/internal/analysisutil",
+        "//go/ast/inspector",
+        "//go/types/typeutil",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = [
+        "printf.go",
+        "types.go",
+    ],
+    importpath = "golang.org/x/tools/go/analysis/passes/printf",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/analysis/passes/inspect:go_tool_library",
+        "//go/analysis/passes/internal/analysisutil:go_tool_library",
+        "//go/ast/inspector:go_tool_library",
+        "//go/types/typeutil:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":printf",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "printf_test",
+    srcs = ["printf_test.go"],
+    embed = [":printf"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/printf/testdata/src/a/BUILD.bazel c/go/analysis/passes/printf/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/printf/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/printf/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/printf/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/printf/testdata/src/b/BUILD.bazel c/go/analysis/passes/printf/testdata/src/b/BUILD.bazel
--- b/go/analysis/passes/printf/testdata/src/b/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/printf/testdata/src/b/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "b",
+    srcs = ["b.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/printf/testdata/src/b",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":b",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/printf/testdata/src/nofmt/BUILD.bazel c/go/analysis/passes/printf/testdata/src/nofmt/BUILD.bazel
--- b/go/analysis/passes/printf/testdata/src/nofmt/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/printf/testdata/src/nofmt/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "nofmt",
+    srcs = ["nofmt.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/printf/testdata/src/nofmt",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":nofmt",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/shadow/BUILD.bazel c/go/analysis/passes/shadow/BUILD.bazel
--- b/go/analysis/passes/shadow/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/shadow/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,38 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "shadow",
+    srcs = ["shadow.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/shadow",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/ast/inspector",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["shadow.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/shadow",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/analysis/passes/inspect:go_tool_library",
+        "//go/ast/inspector:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":shadow",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "shadow_test",
+    srcs = ["shadow_test.go"],
+    embed = [":shadow"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/shadow/cmd/shadow/BUILD.bazel c/go/analysis/passes/shadow/cmd/shadow/BUILD.bazel
--- b/go/analysis/passes/shadow/cmd/shadow/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/shadow/cmd/shadow/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,18 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "shadow_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/shadow/cmd/shadow",
+    visibility = ["//visibility:private"],
+    deps = [
+        "//go/analysis/passes/shadow",
+        "//go/analysis/singlechecker",
+    ],
+)
+
+go_binary(
+    name = "shadow",
+    embed = [":shadow_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/shadow/testdata/src/a/BUILD.bazel c/go/analysis/passes/shadow/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/shadow/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/shadow/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/shadow/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/shift/BUILD.bazel c/go/analysis/passes/shift/BUILD.bazel
--- b/go/analysis/passes/shift/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/shift/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,46 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "shift",
+    srcs = [
+        "dead.go",
+        "shift.go",
+    ],
+    importpath = "golang.org/x/tools/go/analysis/passes/shift",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/analysis/passes/internal/analysisutil",
+        "//go/ast/inspector",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = [
+        "dead.go",
+        "shift.go",
+    ],
+    importpath = "golang.org/x/tools/go/analysis/passes/shift",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/analysis/passes/inspect:go_tool_library",
+        "//go/analysis/passes/internal/analysisutil:go_tool_library",
+        "//go/ast/inspector:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":shift",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "shift_test",
+    srcs = ["shift_test.go"],
+    embed = [":shift"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/shift/testdata/src/a/BUILD.bazel c/go/analysis/passes/shift/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/shift/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/shift/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/shift/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/sortslice/BUILD.bazel c/go/analysis/passes/sortslice/BUILD.bazel
--- b/go/analysis/passes/sortslice/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/sortslice/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,40 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "sortslice",
+    srcs = ["analyzer.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/sortslice",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/ast/inspector",
+        "//go/types/typeutil",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["analyzer.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/sortslice",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/analysis/passes/inspect:go_tool_library",
+        "//go/ast/inspector:go_tool_library",
+        "//go/types/typeutil:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":sortslice",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "sortslice_test",
+    srcs = ["analyzer_test.go"],
+    embed = [":sortslice"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/sortslice/testdata/src/a/BUILD.bazel c/go/analysis/passes/sortslice/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/sortslice/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/sortslice/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/sortslice/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/stdmethods/BUILD.bazel c/go/analysis/passes/stdmethods/BUILD.bazel
--- b/go/analysis/passes/stdmethods/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/stdmethods/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,38 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "stdmethods",
+    srcs = ["stdmethods.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/stdmethods",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/ast/inspector",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["stdmethods.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/stdmethods",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/analysis/passes/inspect:go_tool_library",
+        "//go/ast/inspector:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":stdmethods",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "stdmethods_test",
+    srcs = ["stdmethods_test.go"],
+    embed = [":stdmethods"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/stdmethods/testdata/src/a/BUILD.bazel c/go/analysis/passes/stdmethods/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/stdmethods/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/stdmethods/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/stdmethods/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/stringintconv/BUILD.bazel c/go/analysis/passes/stringintconv/BUILD.bazel
--- b/go/analysis/passes/stringintconv/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/stringintconv/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,38 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "stringintconv",
+    srcs = ["string.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/stringintconv",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/ast/inspector",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["string.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/stringintconv",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/analysis/passes/inspect:go_tool_library",
+        "//go/ast/inspector:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":stringintconv",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "stringintconv_test",
+    srcs = ["string_test.go"],
+    embed = [":stringintconv"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/stringintconv/cmd/stringintconv/BUILD.bazel c/go/analysis/passes/stringintconv/cmd/stringintconv/BUILD.bazel
--- b/go/analysis/passes/stringintconv/cmd/stringintconv/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/stringintconv/cmd/stringintconv/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,18 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "stringintconv_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/stringintconv/cmd/stringintconv",
+    visibility = ["//visibility:private"],
+    deps = [
+        "//go/analysis/passes/stringintconv",
+        "//go/analysis/singlechecker",
+    ],
+)
+
+go_binary(
+    name = "stringintconv",
+    embed = [":stringintconv_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/stringintconv/testdata/src/a/BUILD.bazel c/go/analysis/passes/stringintconv/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/stringintconv/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/stringintconv/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/stringintconv/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/structtag/BUILD.bazel c/go/analysis/passes/structtag/BUILD.bazel
--- b/go/analysis/passes/structtag/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/structtag/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,38 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "structtag",
+    srcs = ["structtag.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/structtag",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/ast/inspector",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["structtag.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/structtag",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/analysis/passes/inspect:go_tool_library",
+        "//go/ast/inspector:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":structtag",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "structtag_test",
+    srcs = ["structtag_test.go"],
+    embed = [":structtag"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/structtag/testdata/src/a/BUILD.bazel c/go/analysis/passes/structtag/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/structtag/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/structtag/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/structtag/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/structtag/testdata/src/a/b/BUILD.bazel c/go/analysis/passes/structtag/testdata/src/a/b/BUILD.bazel
--- b/go/analysis/passes/structtag/testdata/src/a/b/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/structtag/testdata/src/a/b/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "b",
+    srcs = ["b.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/structtag/testdata/src/a/b",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":b",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/testinggoroutine/BUILD.bazel c/go/analysis/passes/testinggoroutine/BUILD.bazel
--- b/go/analysis/passes/testinggoroutine/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/testinggoroutine/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,40 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "testinggoroutine",
+    srcs = ["testinggoroutine.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/testinggoroutine",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/analysis/passes/internal/analysisutil",
+        "//go/ast/inspector",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["testinggoroutine.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/testinggoroutine",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/analysis/passes/inspect:go_tool_library",
+        "//go/analysis/passes/internal/analysisutil:go_tool_library",
+        "//go/ast/inspector:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":testinggoroutine",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "testinggoroutine_test",
+    srcs = ["testinggoroutine_test.go"],
+    embed = [":testinggoroutine"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/testinggoroutine/testdata/src/a/BUILD.bazel c/go/analysis/passes/testinggoroutine/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/testinggoroutine/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/testinggoroutine/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/testinggoroutine/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/tests/BUILD.bazel c/go/analysis/passes/tests/BUILD.bazel
--- b/go/analysis/passes/tests/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/tests/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,30 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "tests",
+    srcs = ["tests.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/tests",
+    visibility = ["//visibility:public"],
+    deps = ["//go/analysis"],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["tests.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/tests",
+    visibility = ["//visibility:public"],
+    deps = ["//go/analysis:go_tool_library"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":tests",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "tests_test",
+    srcs = ["tests_test.go"],
+    embed = [":tests"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/tests/testdata/src/a/BUILD.bazel c/go/analysis/passes/tests/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/tests/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/tests/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,23 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/tests/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "a_test",
+    srcs = [
+        "a_test.go",
+        "ax_test.go",
+    ],
+    embed = [":a"],
+)
diff -urN b/go/analysis/passes/tests/testdata/src/b/BUILD.bazel c/go/analysis/passes/tests/testdata/src/b/BUILD.bazel
--- b/go/analysis/passes/tests/testdata/src/b/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/tests/testdata/src/b/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "b",
+    srcs = ["b.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/tests/testdata/src/b",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":b",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/tests/testdata/src/b_x_test/BUILD.bazel c/go/analysis/passes/tests/testdata/src/b_x_test/BUILD.bazel
--- b/go/analysis/passes/tests/testdata/src/b_x_test/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/tests/testdata/src/b_x_test/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,6 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_test")
+
+go_test(
+    name = "b_x_test_test",
+    srcs = ["b_test.go"],
+)
diff -urN b/go/analysis/passes/tests/testdata/src/divergent/BUILD.bazel c/go/analysis/passes/tests/testdata/src/divergent/BUILD.bazel
--- b/go/analysis/passes/tests/testdata/src/divergent/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/tests/testdata/src/divergent/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,20 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "divergent",
+    srcs = ["buf.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/tests/testdata/src/divergent",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":divergent",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "divergent_test",
+    srcs = ["buf_test.go"],
+    embed = [":divergent"],
+)
diff -urN b/go/analysis/passes/unmarshal/BUILD.bazel c/go/analysis/passes/unmarshal/BUILD.bazel
--- b/go/analysis/passes/unmarshal/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/unmarshal/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,40 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "unmarshal",
+    srcs = ["unmarshal.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/unmarshal",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/ast/inspector",
+        "//go/types/typeutil",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["unmarshal.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/unmarshal",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/analysis/passes/inspect:go_tool_library",
+        "//go/ast/inspector:go_tool_library",
+        "//go/types/typeutil:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":unmarshal",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "unmarshal_test",
+    srcs = ["unmarshal_test.go"],
+    embed = [":unmarshal"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/unmarshal/cmd/unmarshal/BUILD.bazel c/go/analysis/passes/unmarshal/cmd/unmarshal/BUILD.bazel
--- b/go/analysis/passes/unmarshal/cmd/unmarshal/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/unmarshal/cmd/unmarshal/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,18 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "unmarshal_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/unmarshal/cmd/unmarshal",
+    visibility = ["//visibility:private"],
+    deps = [
+        "//go/analysis/passes/unmarshal",
+        "//go/analysis/singlechecker",
+    ],
+)
+
+go_binary(
+    name = "unmarshal",
+    embed = [":unmarshal_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/unmarshal/testdata/src/a/BUILD.bazel c/go/analysis/passes/unmarshal/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/unmarshal/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/unmarshal/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/unmarshal/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/unreachable/BUILD.bazel c/go/analysis/passes/unreachable/BUILD.bazel
--- b/go/analysis/passes/unreachable/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/unreachable/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,38 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "unreachable",
+    srcs = ["unreachable.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/unreachable",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/ast/inspector",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["unreachable.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/unreachable",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/analysis/passes/inspect:go_tool_library",
+        "//go/ast/inspector:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":unreachable",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "unreachable_test",
+    srcs = ["unreachable_test.go"],
+    embed = [":unreachable"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/unreachable/testdata/src/a/BUILD.bazel c/go/analysis/passes/unreachable/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/unreachable/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/unreachable/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/unreachable/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/unsafeptr/BUILD.bazel c/go/analysis/passes/unsafeptr/BUILD.bazel
--- b/go/analysis/passes/unsafeptr/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/unsafeptr/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,38 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "unsafeptr",
+    srcs = ["unsafeptr.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/unsafeptr",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/ast/inspector",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["unsafeptr.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/unsafeptr",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/analysis/passes/inspect:go_tool_library",
+        "//go/ast/inspector:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":unsafeptr",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "unsafeptr_test",
+    srcs = ["unsafeptr_test.go"],
+    embed = [":unsafeptr"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/unsafeptr/testdata/src/a/BUILD.bazel c/go/analysis/passes/unsafeptr/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/unsafeptr/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/unsafeptr/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/unsafeptr/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/passes/unusedresult/BUILD.bazel c/go/analysis/passes/unusedresult/BUILD.bazel
--- b/go/analysis/passes/unusedresult/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/unusedresult/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,40 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "unusedresult",
+    srcs = ["unusedresult.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/unusedresult",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/analysis/passes/internal/analysisutil",
+        "//go/ast/inspector",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["unusedresult.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/unusedresult",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis:go_tool_library",
+        "//go/analysis/passes/inspect:go_tool_library",
+        "//go/analysis/passes/internal/analysisutil:go_tool_library",
+        "//go/ast/inspector:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":unusedresult",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "unusedresult_test",
+    srcs = ["unusedresult_test.go"],
+    embed = [":unusedresult"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/go/analysis/passes/unusedresult/testdata/src/a/BUILD.bazel c/go/analysis/passes/unusedresult/testdata/src/a/BUILD.bazel
--- b/go/analysis/passes/unusedresult/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/passes/unusedresult/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/go/analysis/passes/unusedresult/testdata/src/a",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/singlechecker/BUILD.bazel c/go/analysis/singlechecker/BUILD.bazel
--- b/go/analysis/singlechecker/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/singlechecker/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,20 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "singlechecker",
+    srcs = ["singlechecker.go"],
+    importpath = "golang.org/x/tools/go/analysis/singlechecker",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/internal/analysisflags",
+        "//go/analysis/internal/checker",
+        "//go/analysis/unitchecker",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":singlechecker",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/analysis/unitchecker/BUILD.bazel c/go/analysis/unitchecker/BUILD.bazel
--- b/go/analysis/unitchecker/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/analysis/unitchecker/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,33 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "unitchecker",
+    srcs = [
+        "unitchecker.go",
+        "unitchecker112.go",
+    ],
+    importpath = "golang.org/x/tools/go/analysis/unitchecker",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/internal/analysisflags",
+        "//go/analysis/internal/facts",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":unitchecker",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "unitchecker_test",
+    srcs = ["unitchecker_test.go"],
+    embed = [":unitchecker"],
+    deps = [
+        "//go/analysis/passes/findcall",
+        "//go/analysis/passes/printf",
+        "//go/packages/packagestest",
+    ],
+)
diff -urN b/go/ast/astutil/BUILD.bazel c/go/ast/astutil/BUILD.bazel
--- b/go/ast/astutil/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/ast/astutil/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,41 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "astutil",
+    srcs = [
+        "enclosing.go",
+        "imports.go",
+        "rewrite.go",
+        "util.go",
+    ],
+    importpath = "golang.org/x/tools/go/ast/astutil",
+    visibility = ["//visibility:public"],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = [
+        "enclosing.go",
+        "imports.go",
+        "rewrite.go",
+        "util.go",
+    ],
+    importpath = "golang.org/x/tools/go/ast/astutil",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":astutil",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "astutil_test",
+    srcs = [
+        "enclosing_test.go",
+        "imports_test.go",
+        "rewrite_test.go",
+    ],
+    embed = [":astutil"],
+)
diff -urN b/go/ast/inspector/BUILD.bazel c/go/ast/inspector/BUILD.bazel
--- b/go/ast/inspector/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/ast/inspector/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,33 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "inspector",
+    srcs = [
+        "inspector.go",
+        "typeof.go",
+    ],
+    importpath = "golang.org/x/tools/go/ast/inspector",
+    visibility = ["//visibility:public"],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = [
+        "inspector.go",
+        "typeof.go",
+    ],
+    importpath = "golang.org/x/tools/go/ast/inspector",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":inspector",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "inspector_test",
+    srcs = ["inspector_test.go"],
+    embed = [":inspector"],
+)
diff -urN b/go/buildutil/BUILD.bazel c/go/buildutil/BUILD.bazel
--- b/go/buildutil/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/buildutil/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,33 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "buildutil",
+    srcs = [
+        "allpackages.go",
+        "fakecontext.go",
+        "overlay.go",
+        "tags.go",
+        "util.go",
+    ],
+    importpath = "golang.org/x/tools/go/buildutil",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":buildutil",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "buildutil_test",
+    srcs = [
+        "allpackages_test.go",
+        "overlay_test.go",
+        "tags_test.go",
+        "util_test.go",
+        "util_windows_test.go",
+    ],
+    embed = [":buildutil"],
+    deps = ["//go/packages/packagestest"],
+)
diff -urN b/go/callgraph/BUILD.bazel c/go/callgraph/BUILD.bazel
--- b/go/callgraph/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/callgraph/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,18 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "callgraph",
+    srcs = [
+        "callgraph.go",
+        "util.go",
+    ],
+    importpath = "golang.org/x/tools/go/callgraph",
+    visibility = ["//visibility:public"],
+    deps = ["//go/ssa"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":callgraph",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/callgraph/cha/BUILD.bazel c/go/callgraph/cha/BUILD.bazel
--- b/go/callgraph/cha/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/callgraph/cha/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,99 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "cha",
+    srcs = ["cha.go"],
+    importpath = "golang.org/x/tools/go/callgraph/cha",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/callgraph",
+        "//go/ssa",
+        "//go/ssa/ssautil",
+        "//go/types/typeutil",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":cha",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "cha_test",
+    srcs = ["cha_test.go"],
+    embed = [":cha"],
+    deps = select({
+        "@io_bazel_rules_go//go/platform:aix": [
+            "//go/callgraph",
+            "//go/loader",
+            "//go/ssa/ssautil",
+        ],
+        "@io_bazel_rules_go//go/platform:darwin": [
+            "//go/callgraph",
+            "//go/loader",
+            "//go/ssa/ssautil",
+        ],
+        "@io_bazel_rules_go//go/platform:dragonfly": [
+            "//go/callgraph",
+            "//go/loader",
+            "//go/ssa/ssautil",
+        ],
+        "@io_bazel_rules_go//go/platform:freebsd": [
+            "//go/callgraph",
+            "//go/loader",
+            "//go/ssa/ssautil",
+        ],
+        "@io_bazel_rules_go//go/platform:illumos": [
+            "//go/callgraph",
+            "//go/loader",
+            "//go/ssa/ssautil",
+        ],
+        "@io_bazel_rules_go//go/platform:ios": [
+            "//go/callgraph",
+            "//go/loader",
+            "//go/ssa/ssautil",
+        ],
+        "@io_bazel_rules_go//go/platform:js": [
+            "//go/callgraph",
+            "//go/loader",
+            "//go/ssa/ssautil",
+        ],
+        "@io_bazel_rules_go//go/platform:linux": [
+            "//go/callgraph",
+            "//go/loader",
+            "//go/ssa/ssautil",
+        ],
+        "@io_bazel_rules_go//go/platform:nacl": [
+            "//go/callgraph",
+            "//go/loader",
+            "//go/ssa/ssautil",
+        ],
+        "@io_bazel_rules_go//go/platform:netbsd": [
+            "//go/callgraph",
+            "//go/loader",
+            "//go/ssa/ssautil",
+        ],
+        "@io_bazel_rules_go//go/platform:openbsd": [
+            "//go/callgraph",
+            "//go/loader",
+            "//go/ssa/ssautil",
+        ],
+        "@io_bazel_rules_go//go/platform:plan9": [
+            "//go/callgraph",
+            "//go/loader",
+            "//go/ssa/ssautil",
+        ],
+        "@io_bazel_rules_go//go/platform:solaris": [
+            "//go/callgraph",
+            "//go/loader",
+            "//go/ssa/ssautil",
+        ],
+        "@io_bazel_rules_go//go/platform:windows": [
+            "//go/callgraph",
+            "//go/loader",
+            "//go/ssa/ssautil",
+        ],
+        "//conditions:default": [],
+    }),
+)
diff -urN b/go/callgraph/cha/testdata/BUILD.bazel c/go/callgraph/cha/testdata/BUILD.bazel
--- b/go/callgraph/cha/testdata/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/callgraph/cha/testdata/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "testdata_lib",
+    srcs = ["issue23925.go"],
+    importpath = "golang.org/x/tools/go/callgraph/cha/testdata",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "testdata",
+    embed = [":testdata_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/callgraph/rta/BUILD.bazel c/go/callgraph/rta/BUILD.bazel
--- b/go/callgraph/rta/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/callgraph/rta/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,113 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "rta",
+    srcs = ["rta.go"],
+    importpath = "golang.org/x/tools/go/callgraph/rta",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/callgraph",
+        "//go/ssa",
+        "//go/types/typeutil",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":rta",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "rta_test",
+    srcs = ["rta_test.go"],
+    data = glob(["testdata/**"]),
+    embed = [":rta"],
+    deps = select({
+        "@io_bazel_rules_go//go/platform:aix": [
+            "//go/callgraph",
+            "//go/loader",
+            "//go/ssa",
+            "//go/ssa/ssautil",
+        ],
+        "@io_bazel_rules_go//go/platform:darwin": [
+            "//go/callgraph",
+            "//go/loader",
+            "//go/ssa",
+            "//go/ssa/ssautil",
+        ],
+        "@io_bazel_rules_go//go/platform:dragonfly": [
+            "//go/callgraph",
+            "//go/loader",
+            "//go/ssa",
+            "//go/ssa/ssautil",
+        ],
+        "@io_bazel_rules_go//go/platform:freebsd": [
+            "//go/callgraph",
+            "//go/loader",
+            "//go/ssa",
+            "//go/ssa/ssautil",
+        ],
+        "@io_bazel_rules_go//go/platform:illumos": [
+            "//go/callgraph",
+            "//go/loader",
+            "//go/ssa",
+            "//go/ssa/ssautil",
+        ],
+        "@io_bazel_rules_go//go/platform:ios": [
+            "//go/callgraph",
+            "//go/loader",
+            "//go/ssa",
+            "//go/ssa/ssautil",
+        ],
+        "@io_bazel_rules_go//go/platform:js": [
+            "//go/callgraph",
+            "//go/loader",
+            "//go/ssa",
+            "//go/ssa/ssautil",
+        ],
+        "@io_bazel_rules_go//go/platform:linux": [
+            "//go/callgraph",
+            "//go/loader",
+            "//go/ssa",
+            "//go/ssa/ssautil",
+        ],
+        "@io_bazel_rules_go//go/platform:nacl": [
+            "//go/callgraph",
+            "//go/loader",
+            "//go/ssa",
+            "//go/ssa/ssautil",
+        ],
+        "@io_bazel_rules_go//go/platform:netbsd": [
+            "//go/callgraph",
+            "//go/loader",
+            "//go/ssa",
+            "//go/ssa/ssautil",
+        ],
+        "@io_bazel_rules_go//go/platform:openbsd": [
+            "//go/callgraph",
+            "//go/loader",
+            "//go/ssa",
+            "//go/ssa/ssautil",
+        ],
+        "@io_bazel_rules_go//go/platform:plan9": [
+            "//go/callgraph",
+            "//go/loader",
+            "//go/ssa",
+            "//go/ssa/ssautil",
+        ],
+        "@io_bazel_rules_go//go/platform:solaris": [
+            "//go/callgraph",
+            "//go/loader",
+            "//go/ssa",
+            "//go/ssa/ssautil",
+        ],
+        "@io_bazel_rules_go//go/platform:windows": [
+            "//go/callgraph",
+            "//go/loader",
+            "//go/ssa",
+            "//go/ssa/ssautil",
+        ],
+        "//conditions:default": [],
+    }),
+)
diff -urN b/go/callgraph/static/BUILD.bazel c/go/callgraph/static/BUILD.bazel
--- b/go/callgraph/static/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/callgraph/static/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,30 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "static",
+    srcs = ["static.go"],
+    importpath = "golang.org/x/tools/go/callgraph/static",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/callgraph",
+        "//go/ssa",
+        "//go/ssa/ssautil",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":static",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "static_test",
+    srcs = ["static_test.go"],
+    embed = [":static"],
+    deps = [
+        "//go/callgraph",
+        "//go/loader",
+        "//go/ssa/ssautil",
+    ],
+)
diff -urN b/go/cfg/BUILD.bazel c/go/cfg/BUILD.bazel
--- b/go/cfg/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/cfg/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,33 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "cfg",
+    srcs = [
+        "builder.go",
+        "cfg.go",
+    ],
+    importpath = "golang.org/x/tools/go/cfg",
+    visibility = ["//visibility:public"],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = [
+        "builder.go",
+        "cfg.go",
+    ],
+    importpath = "golang.org/x/tools/go/cfg",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":cfg",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "cfg_test",
+    srcs = ["cfg_test.go"],
+    embed = [":cfg"],
+)
diff -urN b/go/expect/BUILD.bazel c/go/expect/BUILD.bazel
--- b/go/expect/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/expect/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,24 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "expect",
+    srcs = [
+        "expect.go",
+        "extract.go",
+    ],
+    importpath = "golang.org/x/tools/go/expect",
+    visibility = ["//visibility:public"],
+    deps = ["@org_golang_x_mod//modfile:go_default_library"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":expect",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "expect_test",
+    srcs = ["expect_test.go"],
+    embed = [":expect"],
+)
diff -urN b/go/expect/testdata/BUILD.bazel c/go/expect/testdata/BUILD.bazel
--- b/go/expect/testdata/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/expect/testdata/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "testdata",
+    srcs = ["test.go"],
+    importpath = "golang.org/x/tools/go/expect/testdata",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":testdata",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/gccgoexportdata/BUILD.bazel c/go/gccgoexportdata/BUILD.bazel
--- b/go/gccgoexportdata/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/gccgoexportdata/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,22 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "gccgoexportdata",
+    srcs = ["gccgoexportdata.go"],
+    importpath = "golang.org/x/tools/go/gccgoexportdata",
+    visibility = ["//visibility:public"],
+    deps = ["//go/internal/gccgoimporter"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":gccgoexportdata",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "gccgoexportdata_test",
+    srcs = ["gccgoexportdata_test.go"],
+    data = glob(["testdata/**"]),
+    embed = [":gccgoexportdata"],
+)
diff -urN b/go/gcexportdata/BUILD.bazel c/go/gcexportdata/BUILD.bazel
--- b/go/gcexportdata/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/gcexportdata/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,39 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "gcexportdata",
+    srcs = [
+        "gcexportdata.go",
+        "importer.go",
+    ],
+    importpath = "golang.org/x/tools/go/gcexportdata",
+    visibility = ["//visibility:public"],
+    deps = ["//go/internal/gcimporter"],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = [
+        "gcexportdata.go",
+        "importer.go",
+    ],
+    importpath = "golang.org/x/tools/go/gcexportdata",
+    visibility = ["//visibility:public"],
+    deps = ["//go/internal/gcimporter:go_tool_library"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":gcexportdata",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "gcexportdata_test",
+    srcs = [
+        "example_test.go",
+        "gcexportdata_test.go",
+    ],
+    data = glob(["testdata/**"]),
+    embed = [":gcexportdata"],
+)
diff -urN b/go/internal/cgo/BUILD.bazel c/go/internal/cgo/BUILD.bazel
--- b/go/internal/cgo/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/internal/cgo/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,17 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "cgo",
+    srcs = [
+        "cgo.go",
+        "cgo_pkgconfig.go",
+    ],
+    importpath = "golang.org/x/tools/go/internal/cgo",
+    visibility = ["//go:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":cgo",
+    visibility = ["//go:__subpackages__"],
+)
diff -urN b/go/internal/gccgoimporter/BUILD.bazel c/go/internal/gccgoimporter/BUILD.bazel
--- b/go/internal/gccgoimporter/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/internal/gccgoimporter/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,34 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "gccgoimporter",
+    srcs = [
+        "ar.go",
+        "backdoor.go",
+        "gccgoinstallation.go",
+        "importer.go",
+        "newInterface10.go",
+        "newInterface11.go",
+        "parser.go",
+    ],
+    importpath = "golang.org/x/tools/go/internal/gccgoimporter",
+    visibility = ["//go:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":gccgoimporter",
+    visibility = ["//go:__subpackages__"],
+)
+
+go_test(
+    name = "gccgoimporter_test",
+    srcs = [
+        "gccgoinstallation_test.go",
+        "importer_test.go",
+        "parser_test.go",
+        "testenv_test.go",
+    ],
+    data = glob(["testdata/**"]),
+    embed = [":gccgoimporter"],
+)
diff -urN b/go/internal/gcimporter/BUILD.bazel c/go/internal/gcimporter/BUILD.bazel
--- b/go/internal/gcimporter/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/internal/gcimporter/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,56 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "gcimporter",
+    srcs = [
+        "bexport.go",
+        "bimport.go",
+        "exportdata.go",
+        "gcimporter.go",
+        "iexport.go",
+        "iimport.go",
+        "newInterface10.go",
+        "newInterface11.go",
+    ],
+    importpath = "golang.org/x/tools/go/internal/gcimporter",
+    visibility = ["//go:__subpackages__"],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = [
+        "bexport.go",
+        "bimport.go",
+        "exportdata.go",
+        "gcimporter.go",
+        "iexport.go",
+        "iimport.go",
+        "newInterface10.go",
+        "newInterface11.go",
+    ],
+    importpath = "golang.org/x/tools/go/internal/gcimporter",
+    visibility = ["//go:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":gcimporter",
+    visibility = ["//go:__subpackages__"],
+)
+
+go_test(
+    name = "gcimporter_test",
+    srcs = [
+        "bexport_test.go",
+        "gcimporter11_test.go",
+        "gcimporter_test.go",
+        "iexport_test.go",
+        "israce_test.go",
+    ],
+    embed = [":gcimporter"],
+    deps = [
+        "//go/buildutil",
+        "//go/loader",
+        "//internal/testenv",
+    ],
+)
diff -urN b/go/internal/gcimporter/testdata/versions/BUILD.bazel c/go/internal/gcimporter/testdata/versions/BUILD.bazel
--- b/go/internal/gcimporter/testdata/versions/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/internal/gcimporter/testdata/versions/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "versions",
+    srcs = ["test.go"],
+    importpath = "golang.org/x/tools/go/internal/gcimporter/testdata/versions",
+    visibility = ["//go:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":versions",
+    visibility = ["//go:__subpackages__"],
+)
diff -urN b/go/internal/packagesdriver/BUILD.bazel c/go/internal/packagesdriver/BUILD.bazel
--- b/go/internal/packagesdriver/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/internal/packagesdriver/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,15 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "packagesdriver",
+    srcs = ["sizes.go"],
+    importpath = "golang.org/x/tools/go/internal/packagesdriver",
+    visibility = ["//go:__subpackages__"],
+    deps = ["//internal/gocommand"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":packagesdriver",
+    visibility = ["//go:__subpackages__"],
+)
diff -urN b/go/loader/BUILD.bazel c/go/loader/BUILD.bazel
--- b/go/loader/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/loader/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,37 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "loader",
+    srcs = [
+        "doc.go",
+        "loader.go",
+        "util.go",
+    ],
+    importpath = "golang.org/x/tools/go/loader",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/ast/astutil",
+        "//go/buildutil",
+        "//go/internal/cgo",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":loader",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "loader_test",
+    srcs = [
+        "example_test.go",
+        "loader_test.go",
+        "stdlib_test.go",
+    ],
+    embed = [":loader"],
+    deps = [
+        "//go/buildutil",
+        "//internal/testenv",
+    ],
+)
diff -urN b/go/loader/testdata/BUILD.bazel c/go/loader/testdata/BUILD.bazel
--- b/go/loader/testdata/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/loader/testdata/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,18 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "testdata",
+    srcs = [
+        "a.go",
+        "b.go",
+        "badpkgdecl.go",
+    ],
+    importpath = "golang.org/x/tools/go/loader/testdata",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":testdata",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/packages/BUILD.bazel c/go/packages/BUILD.bazel
--- b/go/packages/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/packages/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,46 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "packages",
+    srcs = [
+        "doc.go",
+        "external.go",
+        "golist.go",
+        "golist_overlay.go",
+        "loadmode_string.go",
+        "packages.go",
+        "visit.go",
+    ],
+    importpath = "golang.org/x/tools/go/packages",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/gcexportdata",
+        "//go/internal/packagesdriver",
+        "//internal/gocommand",
+        "//internal/packagesinternal",
+        "//internal/typesinternal",
+        "@org_golang_x_xerrors//:go_default_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":packages",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "packages_test",
+    srcs = [
+        "example_test.go",
+        "overlay_test.go",
+        "packages_test.go",
+        "stdlib_test.go",
+    ],
+    embed = [":packages"],
+    deps = [
+        "//go/packages/packagestest",
+        "//internal/packagesinternal",
+        "//internal/testenv",
+    ],
+)
diff -urN b/go/packages/gopackages/BUILD.bazel c/go/packages/gopackages/BUILD.bazel
--- b/go/packages/gopackages/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/packages/gopackages/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,19 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "gopackages_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/go/packages/gopackages",
+    visibility = ["//visibility:private"],
+    deps = [
+        "//go/packages",
+        "//go/types/typeutil",
+        "//internal/tool",
+    ],
+)
+
+go_binary(
+    name = "gopackages",
+    embed = [":gopackages_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/packages/packagestest/BUILD.bazel c/go/packages/packagestest/BUILD.bazel
--- b/go/packages/packagestest/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/packages/packagestest/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,45 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "packagestest",
+    srcs = [
+        "expect.go",
+        "export.go",
+        "gopath.go",
+        "modules.go",
+        "modules_111.go",
+    ],
+    importpath = "golang.org/x/tools/go/packages/packagestest",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/expect",
+        "//go/packages",
+        "//internal/gocommand",
+        "//internal/packagesinternal",
+        "//internal/proxydir",
+        "//internal/span",
+        "//internal/testenv",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":packagestest",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "packagestest_test",
+    srcs = [
+        "expect_test.go",
+        "export_test.go",
+        "gopath_test.go",
+        "modules_test.go",
+    ],
+    embed = [":packagestest"],
+    deps = [
+        "//go/expect",
+        "//internal/span",
+        "//internal/testenv",
+    ],
+)
diff -urN b/go/packages/packagestest/testdata/BUILD.bazel c/go/packages/packagestest/testdata/BUILD.bazel
--- b/go/packages/packagestest/testdata/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/packages/packagestest/testdata/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,23 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "testdata",
+    srcs = ["test.go"],
+    importpath = "golang.org/x/tools/go/packages/packagestest/testdata",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":testdata",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "testdata_test",
+    srcs = [
+        "test_test.go",
+        "x_test.go",
+    ],
+    embed = [":testdata"],
+)
diff -urN b/go/packages/packagestest/testdata/groups/one/modules/example.com/extra/BUILD.bazel c/go/packages/packagestest/testdata/groups/one/modules/example.com/extra/BUILD.bazel
--- b/go/packages/packagestest/testdata/groups/one/modules/example.com/extra/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/packages/packagestest/testdata/groups/one/modules/example.com/extra/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "extra",
+    srcs = ["help.go"],
+    importpath = "golang.org/x/tools/go/packages/packagestest/testdata/groups/one/modules/example.com/extra",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":extra",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/packages/packagestest/testdata/groups/one/primarymod/BUILD.bazel c/go/packages/packagestest/testdata/groups/one/primarymod/BUILD.bazel
--- b/go/packages/packagestest/testdata/groups/one/primarymod/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/packages/packagestest/testdata/groups/one/primarymod/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "primarymod",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/go/packages/packagestest/testdata/groups/one/primarymod",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":primarymod",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/packages/packagestest/testdata/groups/two/modules/example.com/extra/BUILD.bazel c/go/packages/packagestest/testdata/groups/two/modules/example.com/extra/BUILD.bazel
--- b/go/packages/packagestest/testdata/groups/two/modules/example.com/extra/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/packages/packagestest/testdata/groups/two/modules/example.com/extra/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "extra",
+    srcs = ["yo.go"],
+    importpath = "golang.org/x/tools/go/packages/packagestest/testdata/groups/two/modules/example.com/extra",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":extra",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/packages/packagestest/testdata/groups/two/modules/example.com/extra/geez/BUILD.bazel c/go/packages/packagestest/testdata/groups/two/modules/example.com/extra/geez/BUILD.bazel
--- b/go/packages/packagestest/testdata/groups/two/modules/example.com/extra/geez/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/packages/packagestest/testdata/groups/two/modules/example.com/extra/geez/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "geez",
+    srcs = ["help.go"],
+    importpath = "golang.org/x/tools/go/packages/packagestest/testdata/groups/two/modules/example.com/extra/geez",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":geez",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/packages/packagestest/testdata/groups/two/modules/example.com/extra/v2/BUILD.bazel c/go/packages/packagestest/testdata/groups/two/modules/example.com/extra/v2/BUILD.bazel
--- b/go/packages/packagestest/testdata/groups/two/modules/example.com/extra/v2/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/packages/packagestest/testdata/groups/two/modules/example.com/extra/v2/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "extra",
+    srcs = ["me.go"],
+    importpath = "golang.org/x/tools/go/packages/packagestest/testdata/groups/two/modules/example.com/extra/v2",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":extra",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/packages/packagestest/testdata/groups/two/modules/example.com/extra/v2/geez/BUILD.bazel c/go/packages/packagestest/testdata/groups/two/modules/example.com/extra/v2/geez/BUILD.bazel
--- b/go/packages/packagestest/testdata/groups/two/modules/example.com/extra/v2/geez/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/packages/packagestest/testdata/groups/two/modules/example.com/extra/v2/geez/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "geez",
+    srcs = ["help.go"],
+    importpath = "golang.org/x/tools/go/packages/packagestest/testdata/groups/two/modules/example.com/extra/v2/geez",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":geez",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/packages/packagestest/testdata/groups/two/modules/example.com/tempmod/BUILD.bazel c/go/packages/packagestest/testdata/groups/two/modules/example.com/tempmod/BUILD.bazel
--- b/go/packages/packagestest/testdata/groups/two/modules/example.com/tempmod/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/packages/packagestest/testdata/groups/two/modules/example.com/tempmod/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "tempmod",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/go/packages/packagestest/testdata/groups/two/modules/example.com/tempmod",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":tempmod",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/packages/packagestest/testdata/groups/two/modules/example.com/what@v1.0.0/BUILD.bazel c/go/packages/packagestest/testdata/groups/two/modules/example.com/what@v1.0.0/BUILD.bazel
--- b/go/packages/packagestest/testdata/groups/two/modules/example.com/what@v1.0.0/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/packages/packagestest/testdata/groups/two/modules/example.com/what@v1.0.0/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "what@v1.0.0",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/go/packages/packagestest/testdata/groups/two/modules/example.com/what@v1.0.0",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":what@v1.0.0",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/packages/packagestest/testdata/groups/two/modules/example.com/what@v1.1.0/BUILD.bazel c/go/packages/packagestest/testdata/groups/two/modules/example.com/what@v1.1.0/BUILD.bazel
--- b/go/packages/packagestest/testdata/groups/two/modules/example.com/what@v1.1.0/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/packages/packagestest/testdata/groups/two/modules/example.com/what@v1.1.0/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "what@v1.1.0",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/go/packages/packagestest/testdata/groups/two/modules/example.com/what@v1.1.0",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":what@v1.1.0",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/packages/packagestest/testdata/groups/two/primarymod/BUILD.bazel c/go/packages/packagestest/testdata/groups/two/primarymod/BUILD.bazel
--- b/go/packages/packagestest/testdata/groups/two/primarymod/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/packages/packagestest/testdata/groups/two/primarymod/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "primarymod",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/go/packages/packagestest/testdata/groups/two/primarymod",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":primarymod",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/packages/packagestest/testdata/groups/two/primarymod/expect/BUILD.bazel c/go/packages/packagestest/testdata/groups/two/primarymod/expect/BUILD.bazel
--- b/go/packages/packagestest/testdata/groups/two/primarymod/expect/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/packages/packagestest/testdata/groups/two/primarymod/expect/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,20 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "expect",
+    srcs = ["yo.go"],
+    importpath = "golang.org/x/tools/go/packages/packagestest/testdata/groups/two/primarymod/expect",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":expect",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "expect_test",
+    srcs = ["yo_test.go"],
+    embed = [":expect"],
+)
diff -urN b/go/pointer/BUILD.bazel c/go/pointer/BUILD.bazel
--- b/go/pointer/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/pointer/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,111 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "pointer",
+    srcs = [
+        "analysis.go",
+        "api.go",
+        "callgraph.go",
+        "constraint.go",
+        "doc.go",
+        "gen.go",
+        "hvn.go",
+        "intrinsics.go",
+        "labels.go",
+        "opt.go",
+        "print.go",
+        "query.go",
+        "reflect.go",
+        "solve.go",
+        "util.go",
+    ],
+    importpath = "golang.org/x/tools/go/pointer",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//container/intsets",
+        "//go/callgraph",
+        "//go/ssa",
+        "//go/types/typeutil",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":pointer",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "pointer_test",
+    srcs = [
+        "example_test.go",
+        "pointer_test.go",
+        "query_test.go",
+        "stdlib_test.go",
+    ],
+    embed = [":pointer"],
+    deps = [
+        "//go/callgraph",
+        "//go/loader",
+        "//go/ssa",
+        "//go/ssa/ssautil",
+    ] + select({
+        "@io_bazel_rules_go//go/platform:aix": [
+            "//go/buildutil",
+            "//go/types/typeutil",
+        ],
+        "@io_bazel_rules_go//go/platform:darwin": [
+            "//go/buildutil",
+            "//go/types/typeutil",
+        ],
+        "@io_bazel_rules_go//go/platform:dragonfly": [
+            "//go/buildutil",
+            "//go/types/typeutil",
+        ],
+        "@io_bazel_rules_go//go/platform:freebsd": [
+            "//go/buildutil",
+            "//go/types/typeutil",
+        ],
+        "@io_bazel_rules_go//go/platform:illumos": [
+            "//go/buildutil",
+            "//go/types/typeutil",
+        ],
+        "@io_bazel_rules_go//go/platform:ios": [
+            "//go/buildutil",
+            "//go/types/typeutil",
+        ],
+        "@io_bazel_rules_go//go/platform:js": [
+            "//go/buildutil",
+            "//go/types/typeutil",
+        ],
+        "@io_bazel_rules_go//go/platform:linux": [
+            "//go/buildutil",
+            "//go/types/typeutil",
+        ],
+        "@io_bazel_rules_go//go/platform:nacl": [
+            "//go/buildutil",
+            "//go/types/typeutil",
+        ],
+        "@io_bazel_rules_go//go/platform:netbsd": [
+            "//go/buildutil",
+            "//go/types/typeutil",
+        ],
+        "@io_bazel_rules_go//go/platform:openbsd": [
+            "//go/buildutil",
+            "//go/types/typeutil",
+        ],
+        "@io_bazel_rules_go//go/platform:plan9": [
+            "//go/buildutil",
+            "//go/types/typeutil",
+        ],
+        "@io_bazel_rules_go//go/platform:solaris": [
+            "//go/buildutil",
+            "//go/types/typeutil",
+        ],
+        "@io_bazel_rules_go//go/platform:windows": [
+            "//go/buildutil",
+            "//go/types/typeutil",
+        ],
+        "//conditions:default": [],
+    }),
+)
diff -urN b/go/pointer/testdata/BUILD.bazel c/go/pointer/testdata/BUILD.bazel
--- b/go/pointer/testdata/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/pointer/testdata/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,18 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "testdata_lib",
+    srcs = [
+        "finalizer.go",
+        "issue9002.go",
+        "rtti.go",
+    ],
+    importpath = "golang.org/x/tools/go/pointer/testdata",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "testdata",
+    embed = [":testdata_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/ssa/BUILD.bazel c/go/ssa/BUILD.bazel
--- b/go/ssa/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/ssa/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,152 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "ssa",
+    srcs = [
+        "blockopt.go",
+        "builder.go",
+        "const.go",
+        "create.go",
+        "doc.go",
+        "dom.go",
+        "emit.go",
+        "func.go",
+        "identical.go",
+        "identical_17.go",
+        "lift.go",
+        "lvalue.go",
+        "methods.go",
+        "mode.go",
+        "print.go",
+        "sanity.go",
+        "source.go",
+        "ssa.go",
+        "testmain.go",
+        "util.go",
+        "wrappers.go",
+    ],
+    importpath = "golang.org/x/tools/go/ssa",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/ast/astutil",
+        "//go/types/typeutil",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = [
+        "blockopt.go",
+        "builder.go",
+        "const.go",
+        "create.go",
+        "doc.go",
+        "dom.go",
+        "emit.go",
+        "func.go",
+        "identical.go",
+        "identical_17.go",
+        "lift.go",
+        "lvalue.go",
+        "methods.go",
+        "mode.go",
+        "print.go",
+        "sanity.go",
+        "source.go",
+        "ssa.go",
+        "testmain.go",
+        "util.go",
+        "wrappers.go",
+    ],
+    importpath = "golang.org/x/tools/go/ssa",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/ast/astutil:go_tool_library",
+        "//go/types/typeutil:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":ssa",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "ssa_test",
+    srcs = [
+        "builder_test.go",
+        "example_test.go",
+        "identical_test.go",
+        "source_test.go",
+        "stdlib_test.go",
+        "testmain_test.go",
+    ],
+    data = glob(["testdata/**"]),
+    embed = [":ssa"],
+    deps = [
+        "//go/ast/astutil",
+        "//go/expect",
+        "//go/loader",
+        "//go/packages",
+        "//go/ssa/ssautil",
+    ] + select({
+        "@io_bazel_rules_go//go/platform:aix": [
+            "//go/buildutil",
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:darwin": [
+            "//go/buildutil",
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:dragonfly": [
+            "//go/buildutil",
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:freebsd": [
+            "//go/buildutil",
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:illumos": [
+            "//go/buildutil",
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:ios": [
+            "//go/buildutil",
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:js": [
+            "//go/buildutil",
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:linux": [
+            "//go/buildutil",
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:nacl": [
+            "//go/buildutil",
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:netbsd": [
+            "//go/buildutil",
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:openbsd": [
+            "//go/buildutil",
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:plan9": [
+            "//go/buildutil",
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:solaris": [
+            "//go/buildutil",
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:windows": [
+            "//go/buildutil",
+            "//internal/testenv",
+        ],
+        "//conditions:default": [],
+    }),
+)
diff -urN b/go/ssa/interp/BUILD.bazel c/go/ssa/interp/BUILD.bazel
--- b/go/ssa/interp/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/ssa/interp/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,36 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "interp",
+    srcs = [
+        "external.go",
+        "interp.go",
+        "map.go",
+        "ops.go",
+        "reflect.go",
+        "value.go",
+    ],
+    importpath = "golang.org/x/tools/go/ssa/interp",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/ssa",
+        "//go/types/typeutil",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":interp",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "interp_test",
+    srcs = ["interp_test.go"],
+    embed = [":interp"],
+    deps = [
+        "//go/loader",
+        "//go/ssa",
+        "//go/ssa/ssautil",
+    ],
+)
diff -urN b/go/ssa/interp/testdata/BUILD.bazel c/go/ssa/interp/testdata/BUILD.bazel
--- b/go/ssa/interp/testdata/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/ssa/interp/testdata/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,29 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "testdata_lib",
+    srcs = [
+        "boundmeth.go",
+        "complit.go",
+        "coverage.go",
+        "defer.go",
+        "fieldprom.go",
+        "ifaceconv.go",
+        "ifaceprom.go",
+        "initorder.go",
+        "methprom.go",
+        "mrvchain.go",
+        "range.go",
+        "recover.go",
+        "reflect.go",
+        "static.go",
+    ],
+    importpath = "golang.org/x/tools/go/ssa/interp/testdata",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "testdata",
+    embed = [":testdata_lib"],
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/ssa/interp/testdata/src/errors/BUILD.bazel c/go/ssa/interp/testdata/src/errors/BUILD.bazel
--- b/go/ssa/interp/testdata/src/errors/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/ssa/interp/testdata/src/errors/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "errors",
+    srcs = ["errors.go"],
+    importpath = "golang.org/x/tools/go/ssa/interp/testdata/src/errors",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":errors",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/ssa/interp/testdata/src/fmt/BUILD.bazel c/go/ssa/interp/testdata/src/fmt/BUILD.bazel
--- b/go/ssa/interp/testdata/src/fmt/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/ssa/interp/testdata/src/fmt/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "fmt",
+    srcs = ["fmt.go"],
+    importpath = "golang.org/x/tools/go/ssa/interp/testdata/src/fmt",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":fmt",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/ssa/interp/testdata/src/math/BUILD.bazel c/go/ssa/interp/testdata/src/math/BUILD.bazel
--- b/go/ssa/interp/testdata/src/math/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/ssa/interp/testdata/src/math/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "math",
+    srcs = ["math.go"],
+    importpath = "golang.org/x/tools/go/ssa/interp/testdata/src/math",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":math",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/ssa/interp/testdata/src/os/BUILD.bazel c/go/ssa/interp/testdata/src/os/BUILD.bazel
--- b/go/ssa/interp/testdata/src/os/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/ssa/interp/testdata/src/os/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "os",
+    srcs = ["os.go"],
+    importpath = "golang.org/x/tools/go/ssa/interp/testdata/src/os",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":os",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/ssa/interp/testdata/src/reflect/BUILD.bazel c/go/ssa/interp/testdata/src/reflect/BUILD.bazel
--- b/go/ssa/interp/testdata/src/reflect/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/ssa/interp/testdata/src/reflect/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "reflect",
+    srcs = ["reflect.go"],
+    importpath = "golang.org/x/tools/go/ssa/interp/testdata/src/reflect",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":reflect",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/ssa/interp/testdata/src/runtime/BUILD.bazel c/go/ssa/interp/testdata/src/runtime/BUILD.bazel
--- b/go/ssa/interp/testdata/src/runtime/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/ssa/interp/testdata/src/runtime/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "runtime",
+    srcs = ["runtime.go"],
+    importpath = "golang.org/x/tools/go/ssa/interp/testdata/src/runtime",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":runtime",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/ssa/interp/testdata/src/strings/BUILD.bazel c/go/ssa/interp/testdata/src/strings/BUILD.bazel
--- b/go/ssa/interp/testdata/src/strings/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/ssa/interp/testdata/src/strings/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "strings",
+    srcs = ["strings.go"],
+    importpath = "golang.org/x/tools/go/ssa/interp/testdata/src/strings",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":strings",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/ssa/interp/testdata/src/time/BUILD.bazel c/go/ssa/interp/testdata/src/time/BUILD.bazel
--- b/go/ssa/interp/testdata/src/time/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/ssa/interp/testdata/src/time/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "time",
+    srcs = ["time.go"],
+    importpath = "golang.org/x/tools/go/ssa/interp/testdata/src/time",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":time",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/ssa/interp/testdata/src/unicode/utf8/BUILD.bazel c/go/ssa/interp/testdata/src/unicode/utf8/BUILD.bazel
--- b/go/ssa/interp/testdata/src/unicode/utf8/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/ssa/interp/testdata/src/unicode/utf8/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "utf8",
+    srcs = ["utf8.go"],
+    importpath = "golang.org/x/tools/go/ssa/interp/testdata/src/unicode/utf8",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":utf8",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/ssa/interp/testdata/src/unsafe/BUILD.bazel c/go/ssa/interp/testdata/src/unsafe/BUILD.bazel
--- b/go/ssa/interp/testdata/src/unsafe/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/ssa/interp/testdata/src/unsafe/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "unsafe",
+    srcs = ["unsafe.go"],
+    importpath = "golang.org/x/tools/go/ssa/interp/testdata/src/unsafe",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":unsafe",
+    visibility = ["//visibility:public"],
+)
diff -urN b/go/ssa/ssautil/BUILD.bazel c/go/ssa/ssautil/BUILD.bazel
--- b/go/ssa/ssautil/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/ssa/ssautil/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,95 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "ssautil",
+    srcs = [
+        "load.go",
+        "switch.go",
+        "visit.go",
+    ],
+    importpath = "golang.org/x/tools/go/ssa/ssautil",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/loader",
+        "//go/packages",
+        "//go/ssa",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":ssautil",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "ssautil_test",
+    srcs = [
+        "load_test.go",
+        "switch_test.go",
+    ],
+    data = glob(["testdata/**"]),
+    embed = [":ssautil"],
+    deps = [
+        "//go/packages",
+        "//internal/testenv",
+    ] + select({
+        "@io_bazel_rules_go//go/platform:aix": [
+            "//go/loader",
+            "//go/ssa",
+        ],
+        "@io_bazel_rules_go//go/platform:darwin": [
+            "//go/loader",
+            "//go/ssa",
+        ],
+        "@io_bazel_rules_go//go/platform:dragonfly": [
+            "//go/loader",
+            "//go/ssa",
+        ],
+        "@io_bazel_rules_go//go/platform:freebsd": [
+            "//go/loader",
+            "//go/ssa",
+        ],
+        "@io_bazel_rules_go//go/platform:illumos": [
+            "//go/loader",
+            "//go/ssa",
+        ],
+        "@io_bazel_rules_go//go/platform:ios": [
+            "//go/loader",
+            "//go/ssa",
+        ],
+        "@io_bazel_rules_go//go/platform:js": [
+            "//go/loader",
+            "//go/ssa",
+        ],
+        "@io_bazel_rules_go//go/platform:linux": [
+            "//go/loader",
+            "//go/ssa",
+        ],
+        "@io_bazel_rules_go//go/platform:nacl": [
+            "//go/loader",
+            "//go/ssa",
+        ],
+        "@io_bazel_rules_go//go/platform:netbsd": [
+            "//go/loader",
+            "//go/ssa",
+        ],
+        "@io_bazel_rules_go//go/platform:openbsd": [
+            "//go/loader",
+            "//go/ssa",
+        ],
+        "@io_bazel_rules_go//go/platform:plan9": [
+            "//go/loader",
+            "//go/ssa",
+        ],
+        "@io_bazel_rules_go//go/platform:solaris": [
+            "//go/loader",
+            "//go/ssa",
+        ],
+        "@io_bazel_rules_go//go/platform:windows": [
+            "//go/loader",
+            "//go/ssa",
+        ],
+        "//conditions:default": [],
+    }),
+)
diff -urN b/go/types/objectpath/BUILD.bazel c/go/types/objectpath/BUILD.bazel
--- b/go/types/objectpath/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/types/objectpath/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,32 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "objectpath",
+    srcs = ["objectpath.go"],
+    importpath = "golang.org/x/tools/go/types/objectpath",
+    visibility = ["//visibility:public"],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["objectpath.go"],
+    importpath = "golang.org/x/tools/go/types/objectpath",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":objectpath",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "objectpath_test",
+    srcs = ["objectpath_test.go"],
+    embed = [":objectpath"],
+    deps = [
+        "//go/buildutil",
+        "//go/gcexportdata",
+        "//go/loader",
+    ],
+)
diff -urN b/go/types/typeutil/BUILD.bazel c/go/types/typeutil/BUILD.bazel
--- b/go/types/typeutil/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/types/typeutil/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,47 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "typeutil",
+    srcs = [
+        "callee.go",
+        "imports.go",
+        "map.go",
+        "methodsetcache.go",
+        "ui.go",
+    ],
+    importpath = "golang.org/x/tools/go/types/typeutil",
+    visibility = ["//visibility:public"],
+    deps = ["//go/ast/astutil"],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = [
+        "callee.go",
+        "imports.go",
+        "map.go",
+        "methodsetcache.go",
+        "ui.go",
+    ],
+    importpath = "golang.org/x/tools/go/types/typeutil",
+    visibility = ["//visibility:public"],
+    deps = ["//go/ast/astutil:go_tool_library"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":typeutil",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "typeutil_test",
+    srcs = [
+        "callee_test.go",
+        "example_test.go",
+        "imports_test.go",
+        "map_test.go",
+        "ui_test.go",
+    ],
+    embed = [":typeutil"],
+)
diff -urN b/go/vcs/BUILD.bazel c/go/vcs/BUILD.bazel
--- b/go/vcs/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/go/vcs/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,25 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "vcs",
+    srcs = [
+        "discovery.go",
+        "env.go",
+        "http.go",
+        "vcs.go",
+    ],
+    importpath = "golang.org/x/tools/go/vcs",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":vcs",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "vcs_test",
+    srcs = ["vcs_test.go"],
+    embed = [":vcs"],
+)
diff -urN b/godoc/BUILD.bazel c/godoc/BUILD.bazel
--- b/godoc/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/godoc/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,59 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "godoc",
+    srcs = [
+        "corpus.go",
+        "dirtrees.go",
+        "format.go",
+        "godoc.go",
+        "index.go",
+        "linkify.go",
+        "meta.go",
+        "page.go",
+        "parser.go",
+        "pres.go",
+        "search.go",
+        "server.go",
+        "snippet.go",
+        "spec.go",
+        "spot.go",
+        "tab.go",
+        "template.go",
+        "versions.go",
+    ],
+    importpath = "golang.org/x/tools/godoc",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//godoc/analysis",
+        "//godoc/golangorgenv",
+        "//godoc/util",
+        "//godoc/vfs",
+        "//godoc/vfs/httpfs",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":godoc",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "godoc_test",
+    srcs = [
+        "dirtrees_test.go",
+        "godoc17_test.go",
+        "godoc_test.go",
+        "index_test.go",
+        "server_test.go",
+        "spec_test.go",
+        "versions_test.go",
+    ],
+    embed = [":godoc"],
+    deps = [
+        "//godoc/vfs",
+        "//godoc/vfs/gatefs",
+        "//godoc/vfs/mapfs",
+    ],
+)
diff -urN b/godoc/analysis/BUILD.bazel c/godoc/analysis/BUILD.bazel
--- b/godoc/analysis/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/godoc/analysis/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,29 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "analysis",
+    srcs = [
+        "analysis.go",
+        "callgraph.go",
+        "implements.go",
+        "json.go",
+        "peers.go",
+        "typeinfo.go",
+    ],
+    importpath = "golang.org/x/tools/godoc/analysis",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/callgraph",
+        "//go/loader",
+        "//go/pointer",
+        "//go/ssa",
+        "//go/ssa/ssautil",
+        "//go/types/typeutil",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":analysis",
+    visibility = ["//visibility:public"],
+)
diff -urN b/godoc/golangorgenv/BUILD.bazel c/godoc/golangorgenv/BUILD.bazel
--- b/godoc/golangorgenv/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/godoc/golangorgenv/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "golangorgenv",
+    srcs = ["golangorgenv.go"],
+    importpath = "golang.org/x/tools/godoc/golangorgenv",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":golangorgenv",
+    visibility = ["//visibility:public"],
+)
diff -urN b/godoc/redirect/BUILD.bazel c/godoc/redirect/BUILD.bazel
--- b/godoc/redirect/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/godoc/redirect/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,25 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "redirect",
+    srcs = [
+        "hash.go",
+        "redirect.go",
+        "rietveld.go",
+    ],
+    importpath = "golang.org/x/tools/godoc/redirect",
+    visibility = ["//visibility:public"],
+    deps = ["@org_golang_x_net//context/ctxhttp:go_default_library"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":redirect",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "redirect_test",
+    srcs = ["redirect_test.go"],
+    embed = [":redirect"],
+)
diff -urN b/godoc/static/BUILD.bazel c/godoc/static/BUILD.bazel
--- b/godoc/static/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/godoc/static/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,24 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "static",
+    srcs = [
+        "doc.go",
+        "gen.go",
+        "static.go",
+    ],
+    importpath = "golang.org/x/tools/godoc/static",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":static",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "static_test",
+    srcs = ["gen_test.go"],
+    embed = [":static"],
+)
diff -urN b/godoc/util/BUILD.bazel c/godoc/util/BUILD.bazel
--- b/godoc/util/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/godoc/util/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,18 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "util",
+    srcs = [
+        "throttle.go",
+        "util.go",
+    ],
+    importpath = "golang.org/x/tools/godoc/util",
+    visibility = ["//visibility:public"],
+    deps = ["//godoc/vfs"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":util",
+    visibility = ["//visibility:public"],
+)
diff -urN b/godoc/vfs/BUILD.bazel c/godoc/vfs/BUILD.bazel
--- b/godoc/vfs/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/godoc/vfs/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,29 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "vfs",
+    srcs = [
+        "emptyvfs.go",
+        "namespace.go",
+        "os.go",
+        "vfs.go",
+    ],
+    importpath = "golang.org/x/tools/godoc/vfs",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":vfs",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "vfs_test",
+    srcs = [
+        "namespace_test.go",
+        "os_test.go",
+    ],
+    embed = [":vfs"],
+    deps = ["//godoc/vfs/mapfs"],
+)
diff -urN b/godoc/vfs/gatefs/BUILD.bazel c/godoc/vfs/gatefs/BUILD.bazel
--- b/godoc/vfs/gatefs/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/godoc/vfs/gatefs/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,22 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "gatefs",
+    srcs = ["gatefs.go"],
+    importpath = "golang.org/x/tools/godoc/vfs/gatefs",
+    visibility = ["//visibility:public"],
+    deps = ["//godoc/vfs"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":gatefs",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "gatefs_test",
+    srcs = ["gatefs_test.go"],
+    embed = [":gatefs"],
+    deps = ["//godoc/vfs"],
+)
diff -urN b/godoc/vfs/httpfs/BUILD.bazel c/godoc/vfs/httpfs/BUILD.bazel
--- b/godoc/vfs/httpfs/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/godoc/vfs/httpfs/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,15 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "httpfs",
+    srcs = ["httpfs.go"],
+    importpath = "golang.org/x/tools/godoc/vfs/httpfs",
+    visibility = ["//visibility:public"],
+    deps = ["//godoc/vfs"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":httpfs",
+    visibility = ["//visibility:public"],
+)
diff -urN b/godoc/vfs/mapfs/BUILD.bazel c/godoc/vfs/mapfs/BUILD.bazel
--- b/godoc/vfs/mapfs/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/godoc/vfs/mapfs/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,21 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "mapfs",
+    srcs = ["mapfs.go"],
+    importpath = "golang.org/x/tools/godoc/vfs/mapfs",
+    visibility = ["//visibility:public"],
+    deps = ["//godoc/vfs"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":mapfs",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "mapfs_test",
+    srcs = ["mapfs_test.go"],
+    embed = [":mapfs"],
+)
diff -urN b/godoc/vfs/zipfs/BUILD.bazel c/godoc/vfs/zipfs/BUILD.bazel
--- b/godoc/vfs/zipfs/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/godoc/vfs/zipfs/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,22 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "zipfs",
+    srcs = ["zipfs.go"],
+    importpath = "golang.org/x/tools/godoc/vfs/zipfs",
+    visibility = ["//visibility:public"],
+    deps = ["//godoc/vfs"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":zipfs",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "zipfs_test",
+    srcs = ["zipfs_test.go"],
+    embed = [":zipfs"],
+    deps = ["//godoc/vfs"],
+)
diff -urN b/imports/BUILD.bazel c/imports/BUILD.bazel
--- b/imports/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/imports/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,18 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "imports",
+    srcs = ["forward.go"],
+    importpath = "golang.org/x/tools/imports",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//internal/gocommand",
+        "//internal/imports",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":imports",
+    visibility = ["//visibility:public"],
+)
diff -urN b/internal/analysisinternal/BUILD.bazel c/internal/analysisinternal/BUILD.bazel
--- b/internal/analysisinternal/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/analysisinternal/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,29 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_tool_library")
+
+go_library(
+    name = "analysisinternal",
+    srcs = ["analysis.go"],
+    importpath = "golang.org/x/tools/internal/analysisinternal",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//go/ast/astutil",
+        "//internal/lsp/fuzzy",
+    ],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = ["analysis.go"],
+    importpath = "golang.org/x/tools/internal/analysisinternal",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//go/ast/astutil:go_tool_library",
+        "//internal/lsp/fuzzy:go_tool_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":analysisinternal",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/apidiff/BUILD.bazel c/internal/apidiff/BUILD.bazel
--- b/internal/apidiff/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/apidiff/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,30 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "apidiff",
+    srcs = [
+        "apidiff.go",
+        "compatibility.go",
+        "correspondence.go",
+        "messageset.go",
+        "report.go",
+    ],
+    importpath = "golang.org/x/tools/internal/apidiff",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":apidiff",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "apidiff_test",
+    srcs = ["apidiff_test.go"],
+    embed = [":apidiff"],
+    deps = [
+        "//go/packages",
+        "//internal/testenv",
+    ],
+)
diff -urN b/internal/apidiff/testdata/BUILD.bazel c/internal/apidiff/testdata/BUILD.bazel
--- b/internal/apidiff/testdata/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/apidiff/testdata/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "testdata",
+    srcs = ["tests.go"],
+    importpath = "golang.org/x/tools/internal/apidiff/testdata",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":testdata",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/apidiff/testdata/exported_fields/BUILD.bazel c/internal/apidiff/testdata/exported_fields/BUILD.bazel
--- b/internal/apidiff/testdata/exported_fields/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/apidiff/testdata/exported_fields/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "exported_fields",
+    srcs = ["ef.go"],
+    importpath = "golang.org/x/tools/internal/apidiff/testdata/exported_fields",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":exported_fields",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/event/BUILD.bazel c/internal/event/BUILD.bazel
--- b/internal/event/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/event/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,34 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "event",
+    srcs = [
+        "doc.go",
+        "event.go",
+    ],
+    importpath = "golang.org/x/tools/internal/event",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//internal/event/core",
+        "//internal/event/keys",
+        "//internal/event/label",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":event",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "event_test",
+    srcs = ["bench_test.go"],
+    embed = [":event"],
+    deps = [
+        "//internal/event/core",
+        "//internal/event/export",
+        "//internal/event/keys",
+        "//internal/event/label",
+    ],
+)
diff -urN b/internal/event/core/BUILD.bazel c/internal/event/core/BUILD.bazel
--- b/internal/event/core/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/event/core/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,22 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "core",
+    srcs = [
+        "event.go",
+        "export.go",
+        "fast.go",
+    ],
+    importpath = "golang.org/x/tools/internal/event/core",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//internal/event/keys",
+        "//internal/event/label",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":core",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/event/export/BUILD.bazel c/internal/event/export/BUILD.bazel
--- b/internal/event/export/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/event/export/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,38 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "export",
+    srcs = [
+        "id.go",
+        "log.go",
+        "printer.go",
+        "tag.go",
+        "trace.go",
+    ],
+    importpath = "golang.org/x/tools/internal/event/export",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//internal/event",
+        "//internal/event/core",
+        "//internal/event/keys",
+        "//internal/event/label",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":export",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "export_test",
+    srcs = ["log_test.go"],
+    embed = [":export"],
+    deps = [
+        "//internal/event",
+        "//internal/event/core",
+        "//internal/event/keys",
+        "//internal/event/label",
+    ],
+)
diff -urN b/internal/event/export/eventtest/BUILD.bazel c/internal/event/export/eventtest/BUILD.bazel
--- b/internal/event/export/eventtest/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/event/export/eventtest/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,20 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "eventtest",
+    srcs = ["eventtest.go"],
+    importpath = "golang.org/x/tools/internal/event/export/eventtest",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//internal/event",
+        "//internal/event/core",
+        "//internal/event/export",
+        "//internal/event/label",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":eventtest",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/event/export/metric/BUILD.bazel c/internal/event/export/metric/BUILD.bazel
--- b/internal/event/export/metric/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/event/export/metric/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,24 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "metric",
+    srcs = [
+        "data.go",
+        "exporter.go",
+        "info.go",
+    ],
+    importpath = "golang.org/x/tools/internal/event/export/metric",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//internal/event",
+        "//internal/event/core",
+        "//internal/event/keys",
+        "//internal/event/label",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":metric",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/event/export/ocagent/BUILD.bazel c/internal/event/export/ocagent/BUILD.bazel
--- b/internal/event/export/ocagent/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/event/export/ocagent/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,44 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "ocagent",
+    srcs = [
+        "metrics.go",
+        "ocagent.go",
+    ],
+    importpath = "golang.org/x/tools/internal/event/export/ocagent",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//internal/event",
+        "//internal/event/core",
+        "//internal/event/export",
+        "//internal/event/export/metric",
+        "//internal/event/export/ocagent/wire",
+        "//internal/event/keys",
+        "//internal/event/label",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":ocagent",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "ocagent_test",
+    srcs = [
+        "metrics_test.go",
+        "ocagent_test.go",
+        "trace_test.go",
+    ],
+    embed = [":ocagent"],
+    deps = [
+        "//internal/event",
+        "//internal/event/core",
+        "//internal/event/export",
+        "//internal/event/export/metric",
+        "//internal/event/keys",
+        "//internal/event/label",
+    ],
+)
diff -urN b/internal/event/export/ocagent/wire/BUILD.bazel c/internal/event/export/ocagent/wire/BUILD.bazel
--- b/internal/event/export/ocagent/wire/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/event/export/ocagent/wire/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,25 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "wire",
+    srcs = [
+        "common.go",
+        "core.go",
+        "metrics.go",
+        "trace.go",
+    ],
+    importpath = "golang.org/x/tools/internal/event/export/ocagent/wire",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":wire",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "wire_test",
+    srcs = ["metrics_test.go"],
+    embed = [":wire"],
+)
diff -urN b/internal/event/export/prometheus/BUILD.bazel c/internal/event/export/prometheus/BUILD.bazel
--- b/internal/event/export/prometheus/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/event/export/prometheus/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,20 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "prometheus",
+    srcs = ["prometheus.go"],
+    importpath = "golang.org/x/tools/internal/event/export/prometheus",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//internal/event",
+        "//internal/event/core",
+        "//internal/event/export/metric",
+        "//internal/event/label",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":prometheus",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/event/keys/BUILD.bazel c/internal/event/keys/BUILD.bazel
--- b/internal/event/keys/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/event/keys/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,18 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "keys",
+    srcs = [
+        "keys.go",
+        "standard.go",
+    ],
+    importpath = "golang.org/x/tools/internal/event/keys",
+    visibility = ["//:__subpackages__"],
+    deps = ["//internal/event/label"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":keys",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/event/label/BUILD.bazel c/internal/event/label/BUILD.bazel
--- b/internal/event/label/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/event/label/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,21 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "label",
+    srcs = ["label.go"],
+    importpath = "golang.org/x/tools/internal/event/label",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":label",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "label_test",
+    srcs = ["label_test.go"],
+    embed = [":label"],
+    deps = ["//internal/event/keys"],
+)
diff -urN b/internal/fakenet/BUILD.bazel c/internal/fakenet/BUILD.bazel
--- b/internal/fakenet/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/fakenet/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "fakenet",
+    srcs = ["conn.go"],
+    importpath = "golang.org/x/tools/internal/fakenet",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":fakenet",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/fastwalk/BUILD.bazel c/internal/fastwalk/BUILD.bazel
--- b/internal/fastwalk/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/fastwalk/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,28 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "fastwalk",
+    srcs = [
+        "fastwalk.go",
+        "fastwalk_dirent_fileno.go",
+        "fastwalk_dirent_ino.go",
+        "fastwalk_dirent_namlen_bsd.go",
+        "fastwalk_dirent_namlen_linux.go",
+        "fastwalk_portable.go",
+        "fastwalk_unix.go",
+    ],
+    importpath = "golang.org/x/tools/internal/fastwalk",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":fastwalk",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "fastwalk_test",
+    srcs = ["fastwalk_test.go"],
+    embed = [":fastwalk"],
+)
diff -urN b/internal/gocommand/BUILD.bazel c/internal/gocommand/BUILD.bazel
--- b/internal/gocommand/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/gocommand/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,27 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "gocommand",
+    srcs = [
+        "invoke.go",
+        "vendor.go",
+    ],
+    importpath = "golang.org/x/tools/internal/gocommand",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//internal/event",
+        "@org_golang_x_mod//semver:go_default_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":gocommand",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "gocommand_test",
+    srcs = ["invoke_test.go"],
+    embed = [":gocommand"],
+)
diff -urN b/internal/gopathwalk/BUILD.bazel c/internal/gopathwalk/BUILD.bazel
--- b/internal/gopathwalk/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/gopathwalk/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,21 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "gopathwalk",
+    srcs = ["walk.go"],
+    importpath = "golang.org/x/tools/internal/gopathwalk",
+    visibility = ["//:__subpackages__"],
+    deps = ["//internal/fastwalk"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":gopathwalk",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "gopathwalk_test",
+    srcs = ["walk_test.go"],
+    embed = [":gopathwalk"],
+)
diff -urN b/internal/imports/BUILD.bazel c/internal/imports/BUILD.bazel
--- b/internal/imports/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/imports/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,48 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "imports",
+    srcs = [
+        "fix.go",
+        "imports.go",
+        "mod.go",
+        "mod_cache.go",
+        "sortimports.go",
+        "zstdlib.go",
+    ],
+    importpath = "golang.org/x/tools/internal/imports",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//go/ast/astutil",
+        "//internal/gocommand",
+        "//internal/gopathwalk",
+        "@org_golang_x_mod//module:go_default_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":imports",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "imports_test",
+    srcs = [
+        "fix_test.go",
+        "imports_test.go",
+        "mod_cache_test.go",
+        "mod_test.go",
+    ],
+    data = glob(["testdata/**"]),
+    embed = [":imports"],
+    deps = [
+        "//go/packages/packagestest",
+        "//internal/gocommand",
+        "//internal/gopathwalk",
+        "//internal/proxydir",
+        "//internal/testenv",
+        "//txtar",
+        "@org_golang_x_mod//module:go_default_library",
+    ],
+)
diff -urN b/internal/jsonrpc2/BUILD.bazel c/internal/jsonrpc2/BUILD.bazel
--- b/internal/jsonrpc2/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/jsonrpc2/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,42 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "jsonrpc2",
+    srcs = [
+        "conn.go",
+        "handler.go",
+        "jsonrpc2.go",
+        "messages.go",
+        "serve.go",
+        "stream.go",
+        "wire.go",
+    ],
+    importpath = "golang.org/x/tools/internal/jsonrpc2",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//internal/event",
+        "//internal/event/label",
+        "//internal/lsp/debug/tag",
+        "@org_golang_x_xerrors//:go_default_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":jsonrpc2",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "jsonrpc2_test",
+    srcs = [
+        "jsonrpc2_test.go",
+        "serve_test.go",
+        "wire_test.go",
+    ],
+    embed = [":jsonrpc2"],
+    deps = [
+        "//internal/event/export/eventtest",
+        "//internal/stack/stacktest",
+    ],
+)
diff -urN b/internal/jsonrpc2/servertest/BUILD.bazel c/internal/jsonrpc2/servertest/BUILD.bazel
--- b/internal/jsonrpc2/servertest/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/jsonrpc2/servertest/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,22 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "servertest",
+    srcs = ["servertest.go"],
+    importpath = "golang.org/x/tools/internal/jsonrpc2/servertest",
+    visibility = ["//:__subpackages__"],
+    deps = ["//internal/jsonrpc2"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":servertest",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "servertest_test",
+    srcs = ["servertest_test.go"],
+    embed = [":servertest"],
+    deps = ["//internal/jsonrpc2"],
+)
diff -urN b/internal/lsp/BUILD.bazel c/internal/lsp/BUILD.bazel
--- b/internal/lsp/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,76 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "lsp",
+    srcs = [
+        "call_hierarchy.go",
+        "code_action.go",
+        "code_lens.go",
+        "command.go",
+        "completion.go",
+        "definition.go",
+        "diagnostics.go",
+        "folding_range.go",
+        "format.go",
+        "general.go",
+        "highlight.go",
+        "hover.go",
+        "implementation.go",
+        "link.go",
+        "progress.go",
+        "references.go",
+        "rename.go",
+        "server.go",
+        "server_gen.go",
+        "signature_help.go",
+        "symbols.go",
+        "text_synchronization.go",
+        "workspace.go",
+        "workspace_symbol.go",
+    ],
+    importpath = "golang.org/x/tools/internal/lsp",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//go/analysis",
+        "//internal/event",
+        "//internal/imports",
+        "//internal/jsonrpc2",
+        "//internal/lsp/debug",
+        "//internal/lsp/debug/tag",
+        "//internal/lsp/mod",
+        "//internal/lsp/protocol",
+        "//internal/lsp/source",
+        "//internal/span",
+        "//internal/xcontext",
+        "@org_golang_x_mod//modfile:go_default_library",
+        "@org_golang_x_xerrors//:go_default_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":lsp",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "lsp_test",
+    srcs = [
+        "completion_test.go",
+        "lsp_test.go",
+        "progress_test.go",
+    ],
+    embed = [":lsp"],
+    deps = [
+        "//go/packages/packagestest",
+        "//internal/lsp/cache",
+        "//internal/lsp/diff",
+        "//internal/lsp/diff/myers",
+        "//internal/lsp/mod",
+        "//internal/lsp/protocol",
+        "//internal/lsp/source",
+        "//internal/lsp/tests",
+        "//internal/span",
+        "//internal/testenv",
+    ],
+)
diff -urN b/internal/lsp/analysis/fillreturns/BUILD.bazel c/internal/lsp/analysis/fillreturns/BUILD.bazel
--- b/internal/lsp/analysis/fillreturns/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/analysis/fillreturns/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,26 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "fillreturns",
+    srcs = ["fillreturns.go"],
+    importpath = "golang.org/x/tools/internal/lsp/analysis/fillreturns",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//go/analysis",
+        "//go/ast/astutil",
+        "//internal/analysisinternal",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":fillreturns",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "fillreturns_test",
+    srcs = ["fillreturns_test.go"],
+    embed = [":fillreturns"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/internal/lsp/analysis/fillreturns/testdata/src/a/BUILD.bazel c/internal/lsp/analysis/fillreturns/testdata/src/a/BUILD.bazel
--- b/internal/lsp/analysis/fillreturns/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/analysis/fillreturns/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/internal/lsp/analysis/fillreturns/testdata/src/a",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/analysis/fillstruct/BUILD.bazel c/internal/lsp/analysis/fillstruct/BUILD.bazel
--- b/internal/lsp/analysis/fillstruct/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/analysis/fillstruct/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,29 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "fillstruct",
+    srcs = ["fillstruct.go"],
+    importpath = "golang.org/x/tools/internal/lsp/analysis/fillstruct",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/ast/astutil",
+        "//go/ast/inspector",
+        "//internal/analysisinternal",
+        "//internal/span",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":fillstruct",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "fillstruct_test",
+    srcs = ["fillstruct_test.go"],
+    embed = [":fillstruct"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/internal/lsp/analysis/fillstruct/testdata/src/a/BUILD.bazel c/internal/lsp/analysis/fillstruct/testdata/src/a/BUILD.bazel
--- b/internal/lsp/analysis/fillstruct/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/analysis/fillstruct/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/internal/lsp/analysis/fillstruct/testdata/src/a",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/analysis/fillstruct/testdata/src/b/BUILD.bazel c/internal/lsp/analysis/fillstruct/testdata/src/b/BUILD.bazel
--- b/internal/lsp/analysis/fillstruct/testdata/src/b/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/analysis/fillstruct/testdata/src/b/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "b",
+    srcs = ["b.go"],
+    importpath = "golang.org/x/tools/internal/lsp/analysis/fillstruct/testdata/src/b",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":b",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/analysis/nonewvars/BUILD.bazel c/internal/lsp/analysis/nonewvars/BUILD.bazel
--- b/internal/lsp/analysis/nonewvars/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/analysis/nonewvars/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,27 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "nonewvars",
+    srcs = ["nonewvars.go"],
+    importpath = "golang.org/x/tools/internal/lsp/analysis/nonewvars",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/ast/inspector",
+        "//internal/analysisinternal",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":nonewvars",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "nonewvars_test",
+    srcs = ["nonewvars_test.go"],
+    embed = [":nonewvars"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/internal/lsp/analysis/nonewvars/testdata/src/a/BUILD.bazel c/internal/lsp/analysis/nonewvars/testdata/src/a/BUILD.bazel
--- b/internal/lsp/analysis/nonewvars/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/analysis/nonewvars/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/internal/lsp/analysis/nonewvars/testdata/src/a",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/analysis/noresultvalues/BUILD.bazel c/internal/lsp/analysis/noresultvalues/BUILD.bazel
--- b/internal/lsp/analysis/noresultvalues/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/analysis/noresultvalues/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,27 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "noresultvalues",
+    srcs = ["noresultvalues.go"],
+    importpath = "golang.org/x/tools/internal/lsp/analysis/noresultvalues",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/ast/inspector",
+        "//internal/analysisinternal",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":noresultvalues",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "noresultvalues_test",
+    srcs = ["noresultvalues_test.go"],
+    embed = [":noresultvalues"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/internal/lsp/analysis/noresultvalues/testdata/src/a/BUILD.bazel c/internal/lsp/analysis/noresultvalues/testdata/src/a/BUILD.bazel
--- b/internal/lsp/analysis/noresultvalues/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/analysis/noresultvalues/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/internal/lsp/analysis/noresultvalues/testdata/src/a",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/analysis/simplifycompositelit/BUILD.bazel c/internal/lsp/analysis/simplifycompositelit/BUILD.bazel
--- b/internal/lsp/analysis/simplifycompositelit/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/analysis/simplifycompositelit/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,26 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "simplifycompositelit",
+    srcs = ["simplifycompositelit.go"],
+    importpath = "golang.org/x/tools/internal/lsp/analysis/simplifycompositelit",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/ast/inspector",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":simplifycompositelit",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "simplifycompositelit_test",
+    srcs = ["simplifycompositelit_test.go"],
+    embed = [":simplifycompositelit"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/internal/lsp/analysis/simplifycompositelit/testdata/src/a/BUILD.bazel c/internal/lsp/analysis/simplifycompositelit/testdata/src/a/BUILD.bazel
--- b/internal/lsp/analysis/simplifycompositelit/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/analysis/simplifycompositelit/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/internal/lsp/analysis/simplifycompositelit/testdata/src/a",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/analysis/simplifyrange/BUILD.bazel c/internal/lsp/analysis/simplifyrange/BUILD.bazel
--- b/internal/lsp/analysis/simplifyrange/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/analysis/simplifyrange/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,26 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "simplifyrange",
+    srcs = ["simplifyrange.go"],
+    importpath = "golang.org/x/tools/internal/lsp/analysis/simplifyrange",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/ast/inspector",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":simplifyrange",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "simplifyrange_test",
+    srcs = ["simplifyrange_test.go"],
+    embed = [":simplifyrange"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/internal/lsp/analysis/simplifyrange/testdata/src/a/BUILD.bazel c/internal/lsp/analysis/simplifyrange/testdata/src/a/BUILD.bazel
--- b/internal/lsp/analysis/simplifyrange/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/analysis/simplifyrange/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/internal/lsp/analysis/simplifyrange/testdata/src/a",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/analysis/simplifyslice/BUILD.bazel c/internal/lsp/analysis/simplifyslice/BUILD.bazel
--- b/internal/lsp/analysis/simplifyslice/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/analysis/simplifyslice/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,26 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "simplifyslice",
+    srcs = ["simplifyslice.go"],
+    importpath = "golang.org/x/tools/internal/lsp/analysis/simplifyslice",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/ast/inspector",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":simplifyslice",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "simplifyslice_test",
+    srcs = ["simplifyslice_test.go"],
+    embed = [":simplifyslice"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/internal/lsp/analysis/simplifyslice/testdata/src/a/BUILD.bazel c/internal/lsp/analysis/simplifyslice/testdata/src/a/BUILD.bazel
--- b/internal/lsp/analysis/simplifyslice/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/analysis/simplifyslice/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/internal/lsp/analysis/simplifyslice/testdata/src/a",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/analysis/undeclaredname/BUILD.bazel c/internal/lsp/analysis/undeclaredname/BUILD.bazel
--- b/internal/lsp/analysis/undeclaredname/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/analysis/undeclaredname/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,27 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "undeclaredname",
+    srcs = ["undeclared.go"],
+    importpath = "golang.org/x/tools/internal/lsp/analysis/undeclaredname",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//go/analysis",
+        "//go/ast/astutil",
+        "//internal/analysisinternal",
+        "//internal/span",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":undeclaredname",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "undeclaredname_test",
+    srcs = ["undeclared_test.go"],
+    embed = [":undeclaredname"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/internal/lsp/analysis/undeclaredname/testdata/src/a/BUILD.bazel c/internal/lsp/analysis/undeclaredname/testdata/src/a/BUILD.bazel
--- b/internal/lsp/analysis/undeclaredname/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/analysis/undeclaredname/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/internal/lsp/analysis/undeclaredname/testdata/src/a",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/analysis/unusedparams/BUILD.bazel c/internal/lsp/analysis/unusedparams/BUILD.bazel
--- b/internal/lsp/analysis/unusedparams/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/analysis/unusedparams/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,26 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "unusedparams",
+    srcs = ["unusedparams.go"],
+    importpath = "golang.org/x/tools/internal/lsp/analysis/unusedparams",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/inspect",
+        "//go/ast/inspector",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":unusedparams",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "unusedparams_test",
+    srcs = ["unusedparams_test.go"],
+    embed = [":unusedparams"],
+    deps = ["//go/analysis/analysistest"],
+)
diff -urN b/internal/lsp/analysis/unusedparams/testdata/src/a/BUILD.bazel c/internal/lsp/analysis/unusedparams/testdata/src/a/BUILD.bazel
--- b/internal/lsp/analysis/unusedparams/testdata/src/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/analysis/unusedparams/testdata/src/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/internal/lsp/analysis/unusedparams/testdata/src/a",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/browser/BUILD.bazel c/internal/lsp/browser/BUILD.bazel
--- b/internal/lsp/browser/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/browser/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "browser",
+    srcs = ["browser.go"],
+    importpath = "golang.org/x/tools/internal/lsp/browser",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":browser",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/cache/BUILD.bazel c/internal/lsp/cache/BUILD.bazel
--- b/internal/lsp/cache/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/cache/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,62 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "cache",
+    srcs = [
+        "analysis.go",
+        "cache.go",
+        "check.go",
+        "errors.go",
+        "keys.go",
+        "load.go",
+        "mod.go",
+        "mod_tidy.go",
+        "os_darwin.go",
+        "os_windows.go",
+        "parse.go",
+        "pkg.go",
+        "session.go",
+        "snapshot.go",
+        "view.go",
+    ],
+    importpath = "golang.org/x/tools/internal/lsp/cache",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//go/analysis",
+        "//go/packages",
+        "//internal/analysisinternal",
+        "//internal/event",
+        "//internal/event/keys",
+        "//internal/event/label",
+        "//internal/gocommand",
+        "//internal/imports",
+        "//internal/lsp/debug/tag",
+        "//internal/lsp/diff",
+        "//internal/lsp/protocol",
+        "//internal/lsp/source",
+        "//internal/memoize",
+        "//internal/packagesinternal",
+        "//internal/span",
+        "//internal/typesinternal",
+        "//internal/xcontext",
+        "@org_golang_x_mod//modfile:go_default_library",
+        "@org_golang_x_sync//errgroup:go_default_library",
+        "@org_golang_x_xerrors//:go_default_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":cache",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "cache_test",
+    srcs = [
+        "error_test.go",
+        "parse_test.go",
+        "view_test.go",
+    ],
+    embed = [":cache"],
+)
diff -urN b/internal/lsp/cmd/BUILD.bazel c/internal/lsp/cmd/BUILD.bazel
--- b/internal/lsp/cmd/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/cmd/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,72 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "cmd",
+    srcs = [
+        "call_hierarchy.go",
+        "check.go",
+        "cmd.go",
+        "definition.go",
+        "folding_range.go",
+        "format.go",
+        "highlight.go",
+        "implementation.go",
+        "imports.go",
+        "info.go",
+        "inspect.go",
+        "links.go",
+        "prepare_rename.go",
+        "references.go",
+        "rename.go",
+        "serve.go",
+        "signature.go",
+        "suggested_fix.go",
+        "symbols.go",
+        "workspace_symbol.go",
+    ],
+    importpath = "golang.org/x/tools/internal/lsp/cmd",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//internal/fakenet",
+        "//internal/jsonrpc2",
+        "//internal/lsp",
+        "//internal/lsp/browser",
+        "//internal/lsp/cache",
+        "//internal/lsp/debug",
+        "//internal/lsp/diff",
+        "//internal/lsp/lsprpc",
+        "//internal/lsp/protocol",
+        "//internal/lsp/source",
+        "//internal/span",
+        "//internal/tool",
+        "//internal/xcontext",
+        "@org_golang_x_xerrors//:go_default_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":cmd",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "cmd_test",
+    srcs = [
+        "capabilities_test.go",
+        "cmd_test.go",
+        "export_test.go",
+        "serve_test.go",
+    ],
+    embed = [":cmd"],
+    deps = [
+        "//go/packages/packagestest",
+        "//internal/lsp",
+        "//internal/lsp/cache",
+        "//internal/lsp/cmd/test",
+        "//internal/lsp/protocol",
+        "//internal/lsp/tests",
+        "//internal/testenv",
+        "@org_golang_x_xerrors//:go_default_library",
+    ],
+)
diff -urN b/internal/lsp/cmd/test/BUILD.bazel c/internal/lsp/cmd/test/BUILD.bazel
--- b/internal/lsp/cmd/test/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/cmd/test/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,48 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "test",
+    srcs = [
+        "call_hierarchy.go",
+        "check.go",
+        "cmdtest.go",
+        "definition.go",
+        "folding_range.go",
+        "format.go",
+        "highlight.go",
+        "implementation.go",
+        "imports.go",
+        "links.go",
+        "prepare_rename.go",
+        "references.go",
+        "rename.go",
+        "signature.go",
+        "suggested_fix.go",
+        "symbols.go",
+        "workspace_symbol.go",
+    ],
+    importpath = "golang.org/x/tools/internal/lsp/cmd/test",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//go/packages/packagestest",
+        "//internal/jsonrpc2/servertest",
+        "//internal/lsp/cache",
+        "//internal/lsp/cmd",
+        "//internal/lsp/debug",
+        "//internal/lsp/diff",
+        "//internal/lsp/diff/myers",
+        "//internal/lsp/lsprpc",
+        "//internal/lsp/protocol",
+        "//internal/lsp/source",
+        "//internal/lsp/tests",
+        "//internal/span",
+        "//internal/testenv",
+        "//internal/tool",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":test",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/debug/BUILD.bazel c/internal/lsp/debug/BUILD.bazel
--- b/internal/lsp/debug/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/debug/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,38 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "debug",
+    srcs = [
+        "info.1.11.go",
+        "info.1.12.go",
+        "info.go",
+        "metrics.go",
+        "rpc.go",
+        "serve.go",
+        "trace.go",
+    ],
+    importpath = "golang.org/x/tools/internal/lsp/debug",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//internal/event",
+        "//internal/event/core",
+        "//internal/event/export",
+        "//internal/event/export/metric",
+        "//internal/event/export/ocagent",
+        "//internal/event/export/prometheus",
+        "//internal/event/keys",
+        "//internal/event/label",
+        "//internal/gocommand",
+        "//internal/lsp/cache",
+        "//internal/lsp/debug/tag",
+        "//internal/lsp/protocol",
+        "//internal/lsp/source",
+        "@org_golang_x_xerrors//:go_default_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":debug",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/debug/tag/BUILD.bazel c/internal/lsp/debug/tag/BUILD.bazel
--- b/internal/lsp/debug/tag/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/debug/tag/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,15 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "tag",
+    srcs = ["tag.go"],
+    importpath = "golang.org/x/tools/internal/lsp/debug/tag",
+    visibility = ["//:__subpackages__"],
+    deps = ["//internal/event/keys"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":tag",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/diff/BUILD.bazel c/internal/lsp/diff/BUILD.bazel
--- b/internal/lsp/diff/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/diff/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,28 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "diff",
+    srcs = [
+        "diff.go",
+        "unified.go",
+    ],
+    importpath = "golang.org/x/tools/internal/lsp/diff",
+    visibility = ["//:__subpackages__"],
+    deps = ["//internal/span"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":diff",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "diff_test",
+    srcs = ["diff_test.go"],
+    embed = [":diff"],
+    deps = [
+        "//internal/lsp/diff/difftest",
+        "//internal/span",
+    ],
+)
diff -urN b/internal/lsp/diff/difftest/BUILD.bazel c/internal/lsp/diff/difftest/BUILD.bazel
--- b/internal/lsp/diff/difftest/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/diff/difftest/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,25 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "difftest",
+    srcs = ["difftest.go"],
+    importpath = "golang.org/x/tools/internal/lsp/diff/difftest",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//internal/lsp/diff",
+        "//internal/span",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":difftest",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "difftest_test",
+    srcs = ["difftest_test.go"],
+    embed = [":difftest"],
+    deps = ["//internal/testenv"],
+)
diff -urN b/internal/lsp/diff/myers/BUILD.bazel c/internal/lsp/diff/myers/BUILD.bazel
--- b/internal/lsp/diff/myers/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/diff/myers/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,25 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "myers",
+    srcs = ["diff.go"],
+    importpath = "golang.org/x/tools/internal/lsp/diff/myers",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//internal/lsp/diff",
+        "//internal/span",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":myers",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "myers_test",
+    srcs = ["diff_test.go"],
+    embed = [":myers"],
+    deps = ["//internal/lsp/diff/difftest"],
+)
diff -urN b/internal/lsp/fake/BUILD.bazel c/internal/lsp/fake/BUILD.bazel
--- b/internal/lsp/fake/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/fake/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,43 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "fake",
+    srcs = [
+        "client.go",
+        "doc.go",
+        "edit.go",
+        "editor.go",
+        "proxy.go",
+        "sandbox.go",
+        "workdir.go",
+    ],
+    importpath = "golang.org/x/tools/internal/lsp/fake",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//internal/gocommand",
+        "//internal/jsonrpc2",
+        "//internal/lsp/protocol",
+        "//internal/lsp/source",
+        "//internal/proxydir",
+        "//internal/span",
+        "//internal/testenv",
+        "//txtar",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":fake",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "fake_test",
+    srcs = [
+        "edit_test.go",
+        "editor_test.go",
+        "workdir_test.go",
+    ],
+    embed = [":fake"],
+    deps = ["//internal/lsp/protocol"],
+)
diff -urN b/internal/lsp/fuzzy/BUILD.bazel c/internal/lsp/fuzzy/BUILD.bazel
--- b/internal/lsp/fuzzy/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/fuzzy/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,36 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test", "go_tool_library")
+
+go_library(
+    name = "fuzzy",
+    srcs = [
+        "input.go",
+        "matcher.go",
+    ],
+    importpath = "golang.org/x/tools/internal/lsp/fuzzy",
+    visibility = ["//:__subpackages__"],
+)
+
+go_tool_library(
+    name = "go_tool_library",
+    srcs = [
+        "input.go",
+        "matcher.go",
+    ],
+    importpath = "golang.org/x/tools/internal/lsp/fuzzy",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":fuzzy",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "fuzzy_test",
+    srcs = [
+        "input_test.go",
+        "matcher_test.go",
+    ],
+    embed = [":fuzzy"],
+)
diff -urN b/internal/lsp/helper/BUILD.bazel c/internal/lsp/helper/BUILD.bazel
--- b/internal/lsp/helper/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/helper/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "helper_lib",
+    srcs = ["helper.go"],
+    importpath = "golang.org/x/tools/internal/lsp/helper",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "helper",
+    embed = [":helper_lib"],
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/lsprpc/BUILD.bazel c/internal/lsp/lsprpc/BUILD.bazel
--- b/internal/lsp/lsprpc/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/lsprpc/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,43 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "lsprpc",
+    srcs = [
+        "autostart_default.go",
+        "autostart_posix.go",
+        "lsprpc.go",
+    ],
+    importpath = "golang.org/x/tools/internal/lsp/lsprpc",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//internal/event",
+        "//internal/gocommand",
+        "//internal/jsonrpc2",
+        "//internal/lsp",
+        "//internal/lsp/cache",
+        "//internal/lsp/debug",
+        "//internal/lsp/debug/tag",
+        "//internal/lsp/protocol",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":lsprpc",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "lsprpc_test",
+    srcs = ["lsprpc_test.go"],
+    embed = [":lsprpc"],
+    deps = [
+        "//internal/event",
+        "//internal/jsonrpc2",
+        "//internal/jsonrpc2/servertest",
+        "//internal/lsp/cache",
+        "//internal/lsp/debug",
+        "//internal/lsp/fake",
+        "//internal/lsp/protocol",
+    ],
+)
diff -urN b/internal/lsp/mod/BUILD.bazel c/internal/lsp/mod/BUILD.bazel
--- b/internal/lsp/mod/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/mod/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,40 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "mod",
+    srcs = [
+        "code_lens.go",
+        "diagnostics.go",
+        "format.go",
+        "hover.go",
+    ],
+    importpath = "golang.org/x/tools/internal/lsp/mod",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//internal/event",
+        "//internal/lsp/debug/tag",
+        "//internal/lsp/protocol",
+        "//internal/lsp/source",
+        "//internal/span",
+        "@org_golang_x_mod//modfile:go_default_library",
+        "@org_golang_x_mod//module:go_default_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":mod",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "mod_test",
+    srcs = ["mod_test.go"],
+    embed = [":mod"],
+    deps = [
+        "//internal/lsp/cache",
+        "//internal/lsp/tests",
+        "//internal/span",
+        "//internal/testenv",
+    ],
+)
diff -urN b/internal/lsp/mod/testdata/unchanged/BUILD.bazel c/internal/lsp/mod/testdata/unchanged/BUILD.bazel
--- b/internal/lsp/mod/testdata/unchanged/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/mod/testdata/unchanged/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "unchanged",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/internal/lsp/mod/testdata/unchanged",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":unchanged",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/protocol/BUILD.bazel c/internal/lsp/protocol/BUILD.bazel
--- b/internal/lsp/protocol/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/protocol/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,34 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "protocol",
+    srcs = [
+        "context.go",
+        "doc.go",
+        "enums.go",
+        "log.go",
+        "protocol.go",
+        "span.go",
+        "tsclient.go",
+        "tsprotocol.go",
+        "tsserver.go",
+    ],
+    importpath = "golang.org/x/tools/internal/lsp/protocol",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//internal/event",
+        "//internal/event/core",
+        "//internal/event/export",
+        "//internal/event/label",
+        "//internal/jsonrpc2",
+        "//internal/span",
+        "//internal/xcontext",
+        "@org_golang_x_xerrors//:go_default_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":protocol",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/regtest/BUILD.bazel c/internal/lsp/regtest/BUILD.bazel
--- b/internal/lsp/regtest/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/regtest/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,65 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "regtest",
+    srcs = [
+        "doc.go",
+        "env.go",
+        "runner.go",
+        "wrappers.go",
+    ],
+    importpath = "golang.org/x/tools/internal/lsp/regtest",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//internal/jsonrpc2",
+        "//internal/jsonrpc2/servertest",
+        "//internal/lsp/cache",
+        "//internal/lsp/debug",
+        "//internal/lsp/fake",
+        "//internal/lsp/lsprpc",
+        "//internal/lsp/protocol",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":regtest",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "regtest_test",
+    srcs = [
+        "codelens_test.go",
+        "definition_test.go",
+        "diagnostics_test.go",
+        "env_test.go",
+        "fix_test.go",
+        "formatting_test.go",
+        "generate_test.go",
+        "imports_test.go",
+        "link_test.go",
+        "modfile_test.go",
+        "references_test.go",
+        "reg_test.go",
+        "shared_test.go",
+        "stress_test.go",
+        "symbol_helper_test.go",
+        "symbol_test.go",
+        "unix_test.go",
+        "vendor_test.go",
+        "watch_test.go",
+        "workspace_test.go",
+    ],
+    embed = [":regtest"],
+    deps = [
+        "//internal/lsp",
+        "//internal/lsp/cmd",
+        "//internal/lsp/fake",
+        "//internal/lsp/protocol",
+        "//internal/lsp/source",
+        "//internal/lsp/tests",
+        "//internal/testenv",
+        "//internal/tool",
+    ],
+)
diff -urN b/internal/lsp/snippet/BUILD.bazel c/internal/lsp/snippet/BUILD.bazel
--- b/internal/lsp/snippet/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/snippet/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,20 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "snippet",
+    srcs = ["snippet_builder.go"],
+    importpath = "golang.org/x/tools/internal/lsp/snippet",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":snippet",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "snippet_test",
+    srcs = ["snippet_builder_test.go"],
+    embed = [":snippet"],
+)
diff -urN b/internal/lsp/source/BUILD.bazel c/internal/lsp/source/BUILD.bazel
--- b/internal/lsp/source/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/source/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,128 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "source",
+    srcs = [
+        "call_hierarchy.go",
+        "code_lens.go",
+        "command.go",
+        "comment.go",
+        "completion.go",
+        "completion_builtin.go",
+        "completion_format.go",
+        "completion_keywords.go",
+        "completion_labels.go",
+        "completion_literal.go",
+        "completion_printf.go",
+        "completion_snippet.go",
+        "completion_statements.go",
+        "deep_completion.go",
+        "diagnostics.go",
+        "extract.go",
+        "folding_range.go",
+        "format.go",
+        "gc_annotations.go",
+        "highlight.go",
+        "hover.go",
+        "identifier.go",
+        "implementation.go",
+        "options.go",
+        "references.go",
+        "rename.go",
+        "rename_check.go",
+        "signature_help.go",
+        "symbols.go",
+        "types_format.go",
+        "util.go",
+        "view.go",
+        "workspace_symbol.go",
+    ],
+    importpath = "golang.org/x/tools/internal/lsp/source",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//go/analysis",
+        "//go/analysis/passes/asmdecl",
+        "//go/analysis/passes/assign",
+        "//go/analysis/passes/atomic",
+        "//go/analysis/passes/atomicalign",
+        "//go/analysis/passes/bools",
+        "//go/analysis/passes/buildtag",
+        "//go/analysis/passes/cgocall",
+        "//go/analysis/passes/composite",
+        "//go/analysis/passes/copylock",
+        "//go/analysis/passes/deepequalerrors",
+        "//go/analysis/passes/errorsas",
+        "//go/analysis/passes/httpresponse",
+        "//go/analysis/passes/loopclosure",
+        "//go/analysis/passes/lostcancel",
+        "//go/analysis/passes/nilfunc",
+        "//go/analysis/passes/printf",
+        "//go/analysis/passes/shift",
+        "//go/analysis/passes/sortslice",
+        "//go/analysis/passes/stdmethods",
+        "//go/analysis/passes/structtag",
+        "//go/analysis/passes/testinggoroutine",
+        "//go/analysis/passes/tests",
+        "//go/analysis/passes/unmarshal",
+        "//go/analysis/passes/unreachable",
+        "//go/analysis/passes/unsafeptr",
+        "//go/analysis/passes/unusedresult",
+        "//go/ast/astutil",
+        "//go/packages",
+        "//go/types/typeutil",
+        "//internal/analysisinternal",
+        "//internal/event",
+        "//internal/imports",
+        "//internal/lsp/analysis/fillreturns",
+        "//internal/lsp/analysis/fillstruct",
+        "//internal/lsp/analysis/nonewvars",
+        "//internal/lsp/analysis/noresultvalues",
+        "//internal/lsp/analysis/simplifycompositelit",
+        "//internal/lsp/analysis/simplifyrange",
+        "//internal/lsp/analysis/simplifyslice",
+        "//internal/lsp/analysis/undeclaredname",
+        "//internal/lsp/analysis/unusedparams",
+        "//internal/lsp/debug/tag",
+        "//internal/lsp/diff",
+        "//internal/lsp/diff/myers",
+        "//internal/lsp/fuzzy",
+        "//internal/lsp/protocol",
+        "//internal/lsp/snippet",
+        "//internal/span",
+        "//refactor/satisfy",
+        "@org_golang_x_mod//modfile:go_default_library",
+        "@org_golang_x_xerrors//:go_default_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":source",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "source_test",
+    srcs = [
+        "comment_test.go",
+        "completion_printf_test.go",
+        "deep_completion_test.go",
+        "format_test.go",
+        "identifier_test.go",
+        "source_test.go",
+        "util_test.go",
+    ],
+    embed = [":source"],
+    deps = [
+        "//go/packages/packagestest",
+        "//internal/lsp/cache",
+        "//internal/lsp/diff",
+        "//internal/lsp/diff/myers",
+        "//internal/lsp/fuzzy",
+        "//internal/lsp/protocol",
+        "//internal/lsp/tests",
+        "//internal/span",
+        "//internal/testenv",
+        "@org_golang_x_xerrors//:go_default_library",
+    ],
+)
diff -urN b/internal/lsp/testdata/lsp/modules/example.com/extramodule/pkg/BUILD.bazel c/internal/lsp/testdata/lsp/modules/example.com/extramodule/pkg/BUILD.bazel
--- b/internal/lsp/testdata/lsp/modules/example.com/extramodule/pkg/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/modules/example.com/extramodule/pkg/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "pkg",
+    srcs = ["x.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/modules/example.com/extramodule/pkg",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":pkg",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/%percent/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/%percent/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/%percent/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/%percent/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "%percent",
+    srcs = ["perc%ent.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/%percent",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":%percent",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/address/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/address/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/address/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/address/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "address",
+    srcs = ["address.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/address",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":address",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/analyzer/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/analyzer/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/analyzer/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/analyzer/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,6 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_test")
+
+go_test(
+    name = "analyzer_test",
+    srcs = ["bad_test.go"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/append/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/append/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/append/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/append/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "append",
+    srcs = ["append.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/append",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":append",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/assign/internal/secret/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/assign/internal/secret/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/assign/internal/secret/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/assign/internal/secret/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "secret",
+    srcs = ["secret.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/assign/internal/secret",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":secret",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/bad/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/bad/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/bad/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/bad/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,18 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "bad",
+    srcs = [
+        "bad0.go",
+        "bad1.go",
+        "badimport.go",
+    ],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/bad",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":bad",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/basiclit/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/basiclit/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/basiclit/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/basiclit/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "basiclit",
+    srcs = ["basiclit.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/basiclit",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":basiclit",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/builtins/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/builtins/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/builtins/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/builtins/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,19 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "builtins",
+    srcs = [
+        "builtin_args.go",
+        "builtin_types.go",
+        "builtins.go",
+        "constants.go",
+    ],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/builtins",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":builtins",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/callhierarchy/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/callhierarchy/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/callhierarchy/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/callhierarchy/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "callhierarchy",
+    srcs = ["callhierarchy.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/callhierarchy",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":callhierarchy",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/callhierarchy/incoming/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/callhierarchy/incoming/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/callhierarchy/incoming/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/callhierarchy/incoming/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "incoming",
+    srcs = ["incoming.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/callhierarchy/incoming",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":incoming",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/callhierarchy/outgoing/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/callhierarchy/outgoing/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/callhierarchy/outgoing/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/callhierarchy/outgoing/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "outgoing",
+    srcs = ["outgoing.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/callhierarchy/outgoing",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":outgoing",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/casesensitive/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/casesensitive/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/casesensitive/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/casesensitive/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "casesensitive",
+    srcs = ["casesensitive.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/casesensitive",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":casesensitive",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/cgo/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/cgo/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/cgo/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/cgo/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,18 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "cgo",
+    srcs = [
+        "declarecgo.go",
+        "declarecgo_nocgo.go",
+    ],
+    cgo = True,
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/cgo",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":cgo",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/channel/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/channel/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/channel/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/channel/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "channel",
+    srcs = ["channel.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/channel",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":channel",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/circular/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/circular/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/circular/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/circular/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "circular",
+    srcs = ["self.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/circular",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":circular",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/circular/double/b/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/circular/double/b/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/circular/double/b/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/circular/double/b/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "b",
+    srcs = ["b.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/circular/double/b",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":b",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/circular/double/one/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/circular/double/one/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/circular/double/one/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/circular/double/one/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "one",
+    srcs = ["one.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/circular/double/one",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":one",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/circular/triple/a/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/circular/triple/a/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/circular/triple/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/circular/triple/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/circular/triple/a",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/circular/triple/b/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/circular/triple/b/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/circular/triple/b/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/circular/triple/b/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "b",
+    srcs = ["b.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/circular/triple/b",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":b",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/circular/triple/c/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/circular/triple/c/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/circular/triple/c/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/circular/triple/c/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "c",
+    srcs = ["c.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/circular/triple/c",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":c",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/codelens/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/codelens/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/codelens/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/codelens/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,6 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_test")
+
+go_test(
+    name = "codelens_test",
+    srcs = ["codelens_test.go"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/constant/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/constant/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/constant/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/constant/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "constant",
+    srcs = ["constant.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/constant",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":constant",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/danglingstmt/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/danglingstmt/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/danglingstmt/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/danglingstmt/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,28 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "danglingstmt",
+    srcs = [
+        "dangling_for.go",
+        "dangling_for_init.go",
+        "dangling_for_init_cond.go",
+        "dangling_for_init_cond_post.go",
+        "dangling_if.go",
+        "dangling_if_eof.go",
+        "dangling_if_init.go",
+        "dangling_if_init_cond.go",
+        "dangling_multiline_if.go",
+        "dangling_selector_1.go",
+        "dangling_selector_2.go",
+        "dangling_switch_init.go",
+        "dangling_switch_init_tag.go",
+    ],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/danglingstmt",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":danglingstmt",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/deep/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/deep/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/deep/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/deep/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "deep",
+    srcs = ["deep.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/deep",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":deep",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/errors/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/errors/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/errors/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/errors/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "errors",
+    srcs = ["errors.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/errors",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":errors",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/extract/extract_function/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/extract/extract_function/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/extract/extract_function/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/extract/extract_function/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,26 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "extract_function",
+    srcs = [
+        "extract_args_returns.go",
+        "extract_basic.go",
+        "extract_redefine.go",
+        "extract_return_basic.go",
+        "extract_return_complex.go",
+        "extract_return_func_lit.go",
+        "extract_return_init.go",
+        "extract_scope.go",
+        "extract_smart_initialization.go",
+        "extract_smart_return.go",
+        "extract_unnecessary_param.go",
+    ],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/extract/extract_function",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":extract_function",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/extract/extract_variable/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/extract/extract_variable/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/extract/extract_variable/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/extract/extract_variable/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,18 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "extract_variable",
+    srcs = [
+        "extract_basic_lit.go",
+        "extract_func_call.go",
+        "extract_scope.go",
+    ],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/extract/extract_variable",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":extract_variable",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/fieldlist/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/fieldlist/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/fieldlist/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/fieldlist/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "fieldlist",
+    srcs = ["field_list.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/fieldlist",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":fieldlist",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/fillstruct/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/fillstruct/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/fillstruct/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/fillstruct/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,20 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "fillstruct",
+    srcs = [
+        "a.go",
+        "fill_struct.go",
+        "fill_struct_nested.go",
+        "fill_struct_package.go",
+        "fill_struct_spaces.go",
+    ],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/fillstruct",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":fillstruct",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/fillstruct/data/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/fillstruct/data/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/fillstruct/data/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/fillstruct/data/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "data",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/fillstruct/data",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":data",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/folding/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/folding/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/folding/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/folding/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "folding",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/folding",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":folding",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/foo/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/foo/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/foo/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/foo/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "foo",
+    srcs = ["foo.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/foo",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":foo",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/format/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/format/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/format/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/format/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "format",
+    srcs = ["good_format.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/format",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":format",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/funcsig/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/funcsig/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/funcsig/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/funcsig/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "funcsig",
+    srcs = ["func_sig.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/funcsig",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":funcsig",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/funcvalue/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/funcvalue/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/funcvalue/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/funcvalue/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "funcvalue",
+    srcs = ["func_value.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/funcvalue",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":funcvalue",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/fuzzymatch/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/fuzzymatch/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/fuzzymatch/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/fuzzymatch/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "fuzzymatch",
+    srcs = ["fuzzymatch.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/fuzzymatch",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":fuzzymatch",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/generate/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/generate/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/generate/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/generate/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "generate",
+    srcs = ["generate.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/generate",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":generate",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/generated/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/generated/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/generated/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/generated/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,17 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "generated",
+    srcs = [
+        "generated.go",
+        "generator.go",
+    ],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/generated",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":generated",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/godef/a/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/godef/a/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/godef/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/godef/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,28 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "a",
+    srcs = [
+        "a.go",
+        "d.go",
+        "f.go",
+        "random.go",
+    ],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/godef/a",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "a_test",
+    srcs = [
+        "a_test.go",
+        "a_x_test.go",
+    ],
+    embed = [":a"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/godef/b/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/godef/b/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/godef/b/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/godef/b/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,18 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "b",
+    srcs = [
+        "b.go",
+        "c.go",
+        "e.go",
+    ],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/godef/b",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":b",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/good/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/good/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/good/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/good/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,17 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "good",
+    srcs = [
+        "good0.go",
+        "good1.go",
+    ],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/good",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":good",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/highlights/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/highlights/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/highlights/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/highlights/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "highlights",
+    srcs = ["highlights.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/highlights",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":highlights",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/implementation/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/implementation/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/implementation/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/implementation/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "implementation",
+    srcs = ["implementation.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/implementation",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":implementation",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/implementation/other/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/implementation/other/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/implementation/other/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/implementation/other/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,20 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "other",
+    srcs = ["other.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/implementation/other",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":other",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "other_test",
+    srcs = ["other_test.go"],
+    embed = [":other"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/importedcomplit/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/importedcomplit/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/importedcomplit/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/importedcomplit/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "importedcomplit",
+    srcs = ["imported_complit.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/importedcomplit",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":importedcomplit",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/index/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/index/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/index/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/index/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "index",
+    srcs = ["index.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/index",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":index",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/interfacerank/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/interfacerank/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/interfacerank/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/interfacerank/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "interfacerank",
+    srcs = ["interface_rank.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/interfacerank",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":interfacerank",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/keywords/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/keywords/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/keywords/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/keywords/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,18 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "keywords",
+    srcs = [
+        "empty_select.go",
+        "empty_switch.go",
+        "keywords.go",
+    ],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/keywords",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":keywords",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/labels/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/labels/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/labels/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/labels/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "labels",
+    srcs = ["labels.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/labels",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":labels",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/links/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/links/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/links/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/links/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "links",
+    srcs = ["links.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/links",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":links",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/nodisk/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/nodisk/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/nodisk/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/nodisk/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "nodisk",
+    srcs = ["nodisk.overlay.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/nodisk",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":nodisk",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/printf/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/printf/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/printf/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/printf/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "printf",
+    srcs = ["printf.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/printf",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":printf",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/rank/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/rank/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/rank/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/rank/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "rank",
+    srcs = ["boolexpr_rank.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/rank",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":rank",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/references/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/references/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/references/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/references/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,6 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_test")
+
+go_test(
+    name = "references_test",
+    srcs = ["refs_test.go"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/references/another/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/references/another/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/references/another/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/references/another/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "another",
+    srcs = ["another.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/references/another",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":another",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/references/other/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/references/other/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/references/other/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/references/other/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "other",
+    srcs = ["other.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/references/other",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":other",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/rename/b/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/rename/b/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/rename/b/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/rename/b/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "b",
+    srcs = ["b.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/rename/b",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":b",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/rename/c/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/rename/c/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/rename/c/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/rename/c/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "c",
+    srcs = ["c.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/rename/c",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":c",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/rename/crosspkg/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/rename/crosspkg/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/rename/crosspkg/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/rename/crosspkg/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "crosspkg",
+    srcs = ["crosspkg.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/rename/crosspkg",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":crosspkg",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/rename/crosspkg/another/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/rename/crosspkg/another/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/rename/crosspkg/another/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/rename/crosspkg/another/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "another",
+    srcs = ["another.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/rename/crosspkg/another",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":another",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/rename/crosspkg/other/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/rename/crosspkg/other/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/rename/crosspkg/other/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/rename/crosspkg/other/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "other",
+    srcs = ["other.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/rename/crosspkg/other",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":other",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/rename/testy/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/rename/testy/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/rename/testy/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/rename/testy/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,20 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "testy",
+    srcs = ["testy.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/rename/testy",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":testy",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "testy_test",
+    srcs = ["testy_test.go"],
+    embed = [":testy"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/signature/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/signature/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/signature/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/signature/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,20 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "signature",
+    srcs = ["signature.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/signature",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":signature",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "signature_test",
+    srcs = ["signature_test.go"],
+    embed = [":signature"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/snippets/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/snippets/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/snippets/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/snippets/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "snippets",
+    srcs = ["literal.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/snippets",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":snippets",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/statements/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/statements/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/statements/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/statements/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,18 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "statements",
+    srcs = [
+        "append.go",
+        "if_err_check_return.go",
+        "if_err_check_return_2.go",
+    ],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/statements",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":statements",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/suggestedfix/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/suggestedfix/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/suggestedfix/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/suggestedfix/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "suggestedfix",
+    srcs = ["has_suggested_fix.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/suggestedfix",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":suggestedfix",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/symbols/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/symbols/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/symbols/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/symbols/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "symbols_lib",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/symbols",
+    visibility = ["//visibility:private"],
+)
+
+go_binary(
+    name = "symbols",
+    embed = [":symbols_lib"],
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/testy/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/testy/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/testy/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/testy/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,20 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "testy",
+    srcs = ["testy.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/testy",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":testy",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "testy_test",
+    srcs = ["testy_test.go"],
+    embed = [":testy"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/typeassert/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/typeassert/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/typeassert/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/typeassert/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "typeassert",
+    srcs = ["type_assert.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/typeassert",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":typeassert",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/typeerrors/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/typeerrors/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/typeerrors/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/typeerrors/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "typeerrors",
+    srcs = ["noresultvalues.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/typeerrors",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":typeerrors",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/types/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/types/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/types/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/types/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "types",
+    srcs = ["types.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/types",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":types",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/undeclared/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/undeclared/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/undeclared/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/undeclared/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "undeclared",
+    srcs = ["var.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/undeclared",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":undeclared",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/unimported/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/unimported/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/unimported/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/unimported/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,23 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "unimported",
+    srcs = ["unimported_cand_type.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/unimported",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":unimported",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "unimported_test",
+    srcs = [
+        "export_test.go",
+        "x_test.go",
+    ],
+    embed = [":unimported"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/unsafe/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/unsafe/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/unsafe/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/unsafe/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "unsafe",
+    srcs = ["unsafe.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/unsafe",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":unsafe",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/variadic/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/variadic/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/variadic/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/variadic/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "variadic",
+    srcs = ["variadic_intf.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/variadic",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":variadic",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/workspacesymbol/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/workspacesymbol/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/workspacesymbol/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/workspacesymbol/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "workspacesymbol",
+    srcs = ["workspacesymbol.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/workspacesymbol",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":workspacesymbol",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/workspacesymbol/a/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/workspacesymbol/a/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/workspacesymbol/a/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/workspacesymbol/a/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "a",
+    srcs = ["a.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/workspacesymbol/a",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":a",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/workspacesymbol/b/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/workspacesymbol/b/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/workspacesymbol/b/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/workspacesymbol/b/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "b",
+    srcs = ["b.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/workspacesymbol/b",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":b",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/workspacesymbol/casesensitive/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/workspacesymbol/casesensitive/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/workspacesymbol/casesensitive/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/workspacesymbol/casesensitive/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "casesensitive",
+    srcs = ["casesensitive.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/workspacesymbol/casesensitive",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":casesensitive",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/lsp/primarymod/workspacesymbol/fuzzy/BUILD.bazel c/internal/lsp/testdata/lsp/primarymod/workspacesymbol/fuzzy/BUILD.bazel
--- b/internal/lsp/testdata/lsp/primarymod/workspacesymbol/fuzzy/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/lsp/primarymod/workspacesymbol/fuzzy/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "fuzzy",
+    srcs = ["fuzzy.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/lsp/primarymod/workspacesymbol/fuzzy",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":fuzzy",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/missingdep/modules/example.com/extramodule/pkg/BUILD.bazel c/internal/lsp/testdata/missingdep/modules/example.com/extramodule/pkg/BUILD.bazel
--- b/internal/lsp/testdata/missingdep/modules/example.com/extramodule/pkg/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/missingdep/modules/example.com/extramodule/pkg/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "pkg",
+    srcs = ["x.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/missingdep/modules/example.com/extramodule/pkg",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":pkg",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/missingdep/primarymod/BUILD.bazel c/internal/lsp/testdata/missingdep/primarymod/BUILD.bazel
--- b/internal/lsp/testdata/missingdep/primarymod/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/missingdep/primarymod/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "primarymod",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/missingdep/primarymod",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":primarymod",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/missingdep/primarymod/hello/BUILD.bazel c/internal/lsp/testdata/missingdep/primarymod/hello/BUILD.bazel
--- b/internal/lsp/testdata/missingdep/primarymod/hello/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/missingdep/primarymod/hello/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "hello",
+    srcs = ["hello.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/missingdep/primarymod/hello",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":hello",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/missingtwodep/modules/example.com/anothermodule/hey/BUILD.bazel c/internal/lsp/testdata/missingtwodep/modules/example.com/anothermodule/hey/BUILD.bazel
--- b/internal/lsp/testdata/missingtwodep/modules/example.com/anothermodule/hey/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/missingtwodep/modules/example.com/anothermodule/hey/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "hey",
+    srcs = ["y.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/missingtwodep/modules/example.com/anothermodule/hey",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":hey",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/missingtwodep/modules/example.com/extramodule/pkg/BUILD.bazel c/internal/lsp/testdata/missingtwodep/modules/example.com/extramodule/pkg/BUILD.bazel
--- b/internal/lsp/testdata/missingtwodep/modules/example.com/extramodule/pkg/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/missingtwodep/modules/example.com/extramodule/pkg/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "pkg",
+    srcs = ["x.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/missingtwodep/modules/example.com/extramodule/pkg",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":pkg",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/missingtwodep/modules/example.com/extramodule/yo/BUILD.bazel c/internal/lsp/testdata/missingtwodep/modules/example.com/extramodule/yo/BUILD.bazel
--- b/internal/lsp/testdata/missingtwodep/modules/example.com/extramodule/yo/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/missingtwodep/modules/example.com/extramodule/yo/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "yo",
+    srcs = ["y.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/missingtwodep/modules/example.com/extramodule/yo",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":yo",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/missingtwodep/primarymod/BUILD.bazel c/internal/lsp/testdata/missingtwodep/primarymod/BUILD.bazel
--- b/internal/lsp/testdata/missingtwodep/primarymod/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/missingtwodep/primarymod/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "primarymod",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/missingtwodep/primarymod",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":primarymod",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/unused/modules/example.com/extramodule/pkg/BUILD.bazel c/internal/lsp/testdata/unused/modules/example.com/extramodule/pkg/BUILD.bazel
--- b/internal/lsp/testdata/unused/modules/example.com/extramodule/pkg/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/unused/modules/example.com/extramodule/pkg/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "pkg",
+    srcs = ["x.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/unused/modules/example.com/extramodule/pkg",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":pkg",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/unused/primarymod/BUILD.bazel c/internal/lsp/testdata/unused/primarymod/BUILD.bazel
--- b/internal/lsp/testdata/unused/primarymod/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/unused/primarymod/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "primarymod",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/unused/primarymod",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":primarymod",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/upgradedep/modules/example.com/extramodule@v1.0.0/pkg/BUILD.bazel c/internal/lsp/testdata/upgradedep/modules/example.com/extramodule@v1.0.0/pkg/BUILD.bazel
--- b/internal/lsp/testdata/upgradedep/modules/example.com/extramodule@v1.0.0/pkg/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/upgradedep/modules/example.com/extramodule@v1.0.0/pkg/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "pkg",
+    srcs = ["x.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/upgradedep/modules/example.com/extramodule@v1.0.0/pkg",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":pkg",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/upgradedep/modules/example.com/extramodule@v1.1.0/pkg/BUILD.bazel c/internal/lsp/testdata/upgradedep/modules/example.com/extramodule@v1.1.0/pkg/BUILD.bazel
--- b/internal/lsp/testdata/upgradedep/modules/example.com/extramodule@v1.1.0/pkg/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/upgradedep/modules/example.com/extramodule@v1.1.0/pkg/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "pkg",
+    srcs = ["x.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/upgradedep/modules/example.com/extramodule@v1.1.0/pkg",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":pkg",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/testdata/upgradedep/primarymod/BUILD.bazel c/internal/lsp/testdata/upgradedep/primarymod/BUILD.bazel
--- b/internal/lsp/testdata/upgradedep/primarymod/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/testdata/upgradedep/primarymod/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "primarymod",
+    srcs = ["main.go"],
+    importpath = "golang.org/x/tools/internal/lsp/testdata/upgradedep/primarymod",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":primarymod",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/lsp/tests/BUILD.bazel c/internal/lsp/tests/BUILD.bazel
--- b/internal/lsp/tests/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/lsp/tests/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,30 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "tests",
+    srcs = [
+        "tests.go",
+        "tests_go115.go",
+        "util.go",
+    ],
+    importpath = "golang.org/x/tools/internal/lsp/tests",
+    visibility = ["//:__subpackages__"],
+    deps = [
+        "//go/expect",
+        "//go/packages",
+        "//go/packages/packagestest",
+        "//internal/lsp/diff",
+        "//internal/lsp/diff/myers",
+        "//internal/lsp/protocol",
+        "//internal/lsp/source",
+        "//internal/span",
+        "//internal/testenv",
+        "//txtar",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":tests",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/memoize/BUILD.bazel c/internal/memoize/BUILD.bazel
--- b/internal/memoize/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/memoize/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,21 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "memoize",
+    srcs = ["memoize.go"],
+    importpath = "golang.org/x/tools/internal/memoize",
+    visibility = ["//:__subpackages__"],
+    deps = ["//internal/xcontext"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":memoize",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "memoize_test",
+    srcs = ["memoize_test.go"],
+    embed = [":memoize"],
+)
diff -urN b/internal/packagesinternal/BUILD.bazel c/internal/packagesinternal/BUILD.bazel
--- b/internal/packagesinternal/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/packagesinternal/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,15 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "packagesinternal",
+    srcs = ["packages.go"],
+    importpath = "golang.org/x/tools/internal/packagesinternal",
+    visibility = ["//:__subpackages__"],
+    deps = ["//internal/gocommand"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":packagesinternal",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/proxydir/BUILD.bazel c/internal/proxydir/BUILD.bazel
--- b/internal/proxydir/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/proxydir/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,21 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "proxydir",
+    srcs = ["proxydir.go"],
+    importpath = "golang.org/x/tools/internal/proxydir",
+    visibility = ["//:__subpackages__"],
+    deps = ["//internal/testenv"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":proxydir",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "proxydir_test",
+    srcs = ["proxydir_test.go"],
+    embed = [":proxydir"],
+)
diff -urN b/internal/span/BUILD.bazel c/internal/span/BUILD.bazel
--- b/internal/span/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/span/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,34 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "span",
+    srcs = [
+        "parse.go",
+        "span.go",
+        "token.go",
+        "token111.go",
+        "token112.go",
+        "uri.go",
+        "utf16.go",
+    ],
+    importpath = "golang.org/x/tools/internal/span",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":span",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "span_test",
+    srcs = [
+        "span_test.go",
+        "token_test.go",
+        "uri_test.go",
+        "uri_windows_test.go",
+        "utf16_test.go",
+    ],
+    embed = [":span"],
+)
diff -urN b/internal/stack/BUILD.bazel c/internal/stack/BUILD.bazel
--- b/internal/stack/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/stack/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,24 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "stack",
+    srcs = [
+        "parse.go",
+        "process.go",
+        "stack.go",
+    ],
+    importpath = "golang.org/x/tools/internal/stack",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":stack",
+    visibility = ["//:__subpackages__"],
+)
+
+go_test(
+    name = "stack_test",
+    srcs = ["stack_test.go"],
+    embed = [":stack"],
+)
diff -urN b/internal/stack/gostacks/BUILD.bazel c/internal/stack/gostacks/BUILD.bazel
--- b/internal/stack/gostacks/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/stack/gostacks/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,15 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library")
+
+go_library(
+    name = "gostacks_lib",
+    srcs = ["gostacks.go"],
+    importpath = "golang.org/x/tools/internal/stack/gostacks",
+    visibility = ["//visibility:private"],
+    deps = ["//internal/stack"],
+)
+
+go_binary(
+    name = "gostacks",
+    embed = [":gostacks_lib"],
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/stack/stacktest/BUILD.bazel c/internal/stack/stacktest/BUILD.bazel
--- b/internal/stack/stacktest/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/stack/stacktest/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,15 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "stacktest",
+    srcs = ["stacktest.go"],
+    importpath = "golang.org/x/tools/internal/stack/stacktest",
+    visibility = ["//:__subpackages__"],
+    deps = ["//internal/stack"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":stacktest",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/testenv/BUILD.bazel c/internal/testenv/BUILD.bazel
--- b/internal/testenv/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/testenv/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,17 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "testenv",
+    srcs = [
+        "testenv.go",
+        "testenv_112.go",
+    ],
+    importpath = "golang.org/x/tools/internal/testenv",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":testenv",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/tool/BUILD.bazel c/internal/tool/BUILD.bazel
--- b/internal/tool/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/tool/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "tool",
+    srcs = ["tool.go"],
+    importpath = "golang.org/x/tools/internal/tool",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":tool",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/typesinternal/BUILD.bazel c/internal/typesinternal/BUILD.bazel
--- b/internal/typesinternal/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/typesinternal/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "typesinternal",
+    srcs = ["types.go"],
+    importpath = "golang.org/x/tools/internal/typesinternal",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":typesinternal",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/internal/xcontext/BUILD.bazel c/internal/xcontext/BUILD.bazel
--- b/internal/xcontext/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/internal/xcontext/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,14 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "xcontext",
+    srcs = ["xcontext.go"],
+    importpath = "golang.org/x/tools/internal/xcontext",
+    visibility = ["//:__subpackages__"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":xcontext",
+    visibility = ["//:__subpackages__"],
+)
diff -urN b/playground/BUILD.bazel c/playground/BUILD.bazel
--- b/playground/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/playground/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,15 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "playground",
+    srcs = ["playground.go"],
+    importpath = "golang.org/x/tools/playground",
+    visibility = ["//visibility:public"],
+    deps = ["//godoc/golangorgenv"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":playground",
+    visibility = ["//visibility:public"],
+)
diff -urN b/playground/socket/BUILD.bazel c/playground/socket/BUILD.bazel
--- b/playground/socket/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/playground/socket/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,24 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "socket",
+    srcs = ["socket.go"],
+    importpath = "golang.org/x/tools/playground/socket",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//txtar",
+        "@org_golang_x_net//websocket:go_default_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":socket",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "socket_test",
+    srcs = ["socket_test.go"],
+    embed = [":socket"],
+)
diff -urN b/present/BUILD.bazel c/present/BUILD.bazel
--- b/present/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/present/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,44 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "present",
+    srcs = [
+        "args.go",
+        "caption.go",
+        "code.go",
+        "doc.go",
+        "html.go",
+        "iframe.go",
+        "image.go",
+        "link.go",
+        "parse.go",
+        "style.go",
+        "video.go",
+    ],
+    importpath = "golang.org/x/tools/present",
+    visibility = ["//visibility:public"],
+    deps = [
+        "@com_github_yuin_goldmark//:go_default_library",
+        "@com_github_yuin_goldmark//ast:go_default_library",
+        "@com_github_yuin_goldmark//renderer/html:go_default_library",
+        "@com_github_yuin_goldmark//text:go_default_library",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":present",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "present_test",
+    srcs = [
+        "code_test.go",
+        "link_test.go",
+        "parse_test.go",
+        "style_test.go",
+    ],
+    data = glob(["testdata/**"]),
+    embed = [":present"],
+)
diff -urN b/refactor/eg/BUILD.bazel c/refactor/eg/BUILD.bazel
--- b/refactor/eg/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/refactor/eg/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,85 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "eg",
+    srcs = [
+        "eg.go",
+        "match.go",
+        "rewrite.go",
+    ],
+    importpath = "golang.org/x/tools/refactor/eg",
+    visibility = ["//visibility:public"],
+    deps = ["//go/ast/astutil"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":eg",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "eg_test",
+    srcs = ["eg_test.go"],
+    data = glob(["testdata/**"]),
+    embed = [":eg"],
+    deps = select({
+        "@io_bazel_rules_go//go/platform:aix": [
+            "//go/loader",
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:darwin": [
+            "//go/loader",
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:dragonfly": [
+            "//go/loader",
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:freebsd": [
+            "//go/loader",
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:illumos": [
+            "//go/loader",
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:ios": [
+            "//go/loader",
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:js": [
+            "//go/loader",
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:linux": [
+            "//go/loader",
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:nacl": [
+            "//go/loader",
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:netbsd": [
+            "//go/loader",
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:openbsd": [
+            "//go/loader",
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:plan9": [
+            "//go/loader",
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:solaris": [
+            "//go/loader",
+            "//internal/testenv",
+        ],
+        "@io_bazel_rules_go//go/platform:windows": [
+            "//go/loader",
+            "//internal/testenv",
+        ],
+        "//conditions:default": [],
+    }),
+)
diff -urN b/refactor/importgraph/BUILD.bazel c/refactor/importgraph/BUILD.bazel
--- b/refactor/importgraph/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/refactor/importgraph/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,66 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "importgraph",
+    srcs = ["graph.go"],
+    importpath = "golang.org/x/tools/refactor/importgraph",
+    visibility = ["//visibility:public"],
+    deps = ["//go/buildutil"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":importgraph",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "importgraph_test",
+    srcs = ["graph_test.go"],
+    embed = [":importgraph"],
+    deps = select({
+        "@io_bazel_rules_go//go/platform:aix": [
+            "//go/packages/packagestest",
+        ],
+        "@io_bazel_rules_go//go/platform:darwin": [
+            "//go/packages/packagestest",
+        ],
+        "@io_bazel_rules_go//go/platform:dragonfly": [
+            "//go/packages/packagestest",
+        ],
+        "@io_bazel_rules_go//go/platform:freebsd": [
+            "//go/packages/packagestest",
+        ],
+        "@io_bazel_rules_go//go/platform:illumos": [
+            "//go/packages/packagestest",
+        ],
+        "@io_bazel_rules_go//go/platform:ios": [
+            "//go/packages/packagestest",
+        ],
+        "@io_bazel_rules_go//go/platform:js": [
+            "//go/packages/packagestest",
+        ],
+        "@io_bazel_rules_go//go/platform:linux": [
+            "//go/packages/packagestest",
+        ],
+        "@io_bazel_rules_go//go/platform:nacl": [
+            "//go/packages/packagestest",
+        ],
+        "@io_bazel_rules_go//go/platform:netbsd": [
+            "//go/packages/packagestest",
+        ],
+        "@io_bazel_rules_go//go/platform:openbsd": [
+            "//go/packages/packagestest",
+        ],
+        "@io_bazel_rules_go//go/platform:plan9": [
+            "//go/packages/packagestest",
+        ],
+        "@io_bazel_rules_go//go/platform:solaris": [
+            "//go/packages/packagestest",
+        ],
+        "@io_bazel_rules_go//go/platform:windows": [
+            "//go/packages/packagestest",
+        ],
+        "//conditions:default": [],
+    }),
+)
diff -urN b/refactor/rename/BUILD.bazel c/refactor/rename/BUILD.bazel
--- b/refactor/rename/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/refactor/rename/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,41 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "rename",
+    srcs = [
+        "check.go",
+        "mvpkg.go",
+        "rename.go",
+        "spec.go",
+        "util.go",
+    ],
+    importpath = "golang.org/x/tools/refactor/rename",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/ast/astutil",
+        "//go/buildutil",
+        "//go/loader",
+        "//go/types/typeutil",
+        "//refactor/importgraph",
+        "//refactor/satisfy",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":rename",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "rename_test",
+    srcs = [
+        "mvpkg_test.go",
+        "rename_test.go",
+    ],
+    embed = [":rename"],
+    deps = [
+        "//go/buildutil",
+        "//internal/testenv",
+    ],
+)
diff -urN b/refactor/satisfy/BUILD.bazel c/refactor/satisfy/BUILD.bazel
--- b/refactor/satisfy/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/refactor/satisfy/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,18 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library")
+
+go_library(
+    name = "satisfy",
+    srcs = ["find.go"],
+    importpath = "golang.org/x/tools/refactor/satisfy",
+    visibility = ["//visibility:public"],
+    deps = [
+        "//go/ast/astutil",
+        "//go/types/typeutil",
+    ],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":satisfy",
+    visibility = ["//visibility:public"],
+)
diff -urN b/txtar/BUILD.bazel c/txtar/BUILD.bazel
--- b/txtar/BUILD.bazel	1969-12-31 19:00:00.000000000 -0500
+++ c/txtar/BUILD.bazel	2000-01-01 00:00:00.000000000 -0000
@@ -0,0 +1,20 @@
+load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")
+
+go_library(
+    name = "txtar",
+    srcs = ["archive.go"],
+    importpath = "golang.org/x/tools/txtar",
+    visibility = ["//visibility:public"],
+)
+
+alias(
+    name = "go_default_library",
+    actual = ":txtar",
+    visibility = ["//visibility:public"],
+)
+
+go_test(
+    name = "txtar_test",
+    srcs = ["archive_test.go"],
+    embed = [":txtar"],
+)
